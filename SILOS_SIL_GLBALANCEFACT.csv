"TASK_NAME1","TASK_NAME2","SCEN_TASK_NO","SOURCE","TASK_STATUS","SOURCE_1","TARGET","EXEC_SQL_ON_SOURCE","EXEC_SQL_ON_TARGET","NUMBER_OF_INSERT","NUMBER_OF_UPDATE","NUMBER_OF_DELETE","NB_ERR"
"Variable","IS_INCREMENTAL",1,0,"D","","BIAPPS_DW","","SELECT	(CASE
WHEN COUNT(*)>0 THEN 'Y'
ELSE 'N'
END )
FROM	PRXBI_DW.W_ETL_LOAD_DATES
WHERE	PACKAGE_NAME = 'SILOS_SIL_GLBALANCEFACT'
AND	(DATASOURCE_NUM_ID=#BIAPPS.DATASOURCE_NUM_ID
OR	DATASOURCE_NUM_ID=#BIAPPS.WH_DATASOURCE_NUM_ID)
AND 	ETL_USAGE_CODE = '#BIAPPS.ETL_USAGE_CODE'
AND	COMMITTED='1'",0,0,0,0
"Variable","PRUNE_DAYS",2,0,"D","","BIAPPS_BIACOMP","","",0,0,0,0
"Variable","LAST_EXTRACT_DATE",3,0,"D","","BIAPPS_DW","","SELECT
COALESCE(TO_CHAR(MIN(LAST_MAX_DATE), 'YYYY-MM-DD HH24:MI:SS'),'1970-01-01 00:00:00')
FROM   PRXBI_DW.W_ETL_LOAD_DATES
WHERE PACKAGE_NAME = 'SILOS_SIL_GLBALANCEFACT'
AND       DATASOURCE_NUM_ID=#BIAPPS.DATASOURCE_NUM_ID
AND       ETL_USAGE_CODE = '#BIAPPS.ETL_USAGE_CODE'",0,0,0,0
"Delete matched rows","IKM BIAPPS Oracle Fact Incremental Update",410,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Records are not deleted when running in UPDATE mode */
  ",0,0,0,0
"Variable","UTIL_PARTDDL_TABLE_NAME",4,0,"D","","","","",0,0,0,0
"Procedure","Load Partition Metadata",5,0,"D","","BIAPPS_DW","","/* ===================================================
--  Load Partition Metadata 
--  11.1.1.11.0.20150923 
-- ===================================================

---------------------------------------------------
Options and Variables
---------------------------------------------------
Incremental:		Y
Table Name:		W_GL_BALANCE_F
Data schema:	PRXBI_DW


=================================================== */",0,0,0,0
"Procedure","Load Partition Metadata",6,0,"D","","BIAPPS_DW","","begin

  execute immediate '
create or replace package PRXBI_DW.OBIA_PARTITION_2625555 as

function get_column_expr
 (p_owner            in varchar2,
  p_table_name       in varchar2,
  p_column_name   in varchar2)
     return varchar2;

function get_date_expr
 (p_expr   in varchar2)
     return date;

function get_high_value
 (p_owner            in varchar2,
  p_table_name       in varchar2,
  p_partition_name   in varchar2)
     return varchar2;

function get_index_high_value
 (p_owner            in varchar2,
  p_index_name       in varchar2,
  p_partition_name   in varchar2)
     return varchar2;

end OBIA_PARTITION_2625555;
';

  execute immediate '
create or replace package body PRXBI_DW.OBIA_PARTITION_2625555 as

function get_column_expr
 (p_owner            in varchar2,
  p_table_name       in varchar2,
  p_column_name   in varchar2)
     return varchar2 is

  cursor col_expr_csr is
  select data_default
  from all_tab_columns
  where owner = p_owner
  and table_name = p_table_name
  and column_name = p_column_name;

  l_col_expr         long;

begin

  open col_expr_csr;
  fetch col_expr_csr into l_col_expr;
  close col_expr_csr;
  
  return substr(l_col_expr, 1, 4000);

end get_column_expr;

function get_date_expr
 (p_expr   in varchar2)
     return date is

  l_date date;

begin

  if p_expr = ''MAXVALUE'' then
    l_date := TO_DATE(''01-JAN-3714'',''DD-MON-YYYY'');
  else
    execute immediate ''SELECT '' || p_expr || '' FROM DUAL'' INTO l_date;
  end if;

  return l_date;

end get_date_expr;

function get_high_value
 (p_owner            in varchar2,
  p_table_name       in varchar2,
  p_partition_name   in varchar2)
     return varchar2 is

  cursor high_val_csr is
  select high_value, high_value_length
  from all_tab_partitions
  where table_owner = p_owner
  and table_name = p_table_name
  and partition_name = p_partition_name;

  l_high_value         long;
  l_high_value_length  number;

begin

  open high_val_csr;
  fetch high_val_csr into l_high_value, l_high_value_length;
  close high_val_csr;
  
  return substr(l_high_value, 1, l_high_value_length);
  
end get_high_value;

function get_index_high_value
 (p_owner            in varchar2,
  p_index_name       in varchar2,
  p_partition_name   in varchar2)
     return varchar2 is

  cursor high_val_csr is
  select high_value, high_value_length
  from all_ind_partitions
  where index_owner = p_owner
  and index_name = p_index_name
  and partition_name = p_partition_name;

  l_high_value         long;
  l_high_value_length  number;

begin

  open high_val_csr;
  fetch high_val_csr into l_high_value, l_high_value_length;
  close high_val_csr;
  
  return substr(l_high_value, 1, l_high_value_length);

end get_index_high_value;

end OBIA_PARTITION_2625555;
';

end;",0,0,0,0
"Procedure","Load Partition Metadata",8,3,"D","","BIAPPS_DW","","MERGE INTO PRXBI_DW.W_ETL_PART_TABLES PT
  USING
   (SELECT
     TABLE_NAME,
     PARTITIONING_TYPE,
     INTERVAL,
     SUBPARTITIONING_TYPE,
     KEY_COLUMN_NAME,
     KEY_COLUMN_DATA_TYPE,
     CREATED,
     LAST_DDL_TIME,
     NUMBER_OF_PARTITIONS,
     NEXT_POWER_OF_TWO,
     KEY_COLUMN_EXPRESSION,
     INCR_NUM_ROWS,
     NUM_ROWS
    FROM
     (SELECT
       T.TABLE_NAME,
       T.PARTITIONING_TYPE,
       T.INTERVAL,
       T.SUBPARTITIONING_TYPE,
       C.COLUMN_NAME KEY_COLUMN_NAME,
       C.DATA_TYPE KEY_COLUMN_DATA_TYPE,
       PRXBI_DW.OBIA_PARTITION_2625555.GET_COLUMN_EXPR(C.OWNER, C.TABLE_NAME, C.COLUMN_NAME) KEY_COLUMN_EXPRESSION,
       CREATED,
       LAST_DDL_TIME, 
       T.PARTITION_COUNT NUMBER_OF_PARTITIONS,
       POWER(2, CEIL(LOG(2, T.PARTITION_COUNT)))  NEXT_POWER_OF_TWO,
       0 INCR_NUM_ROWS,
      (SELECT NUM_ROWS FROM ALL_TABLES WHERE TABLE_NAME=T.TABLE_NAME AND OWNER=T.OWNER) NUM_ROWS
      FROM
       ALL_PART_TABLES T,
       ALL_PART_KEY_COLUMNS KC,
       ALL_TAB_COLUMNS C,
       ALL_OBJECTS O
      WHERE T.TABLE_NAME = 'W_GL_BALANCE_F'
      AND T.OWNER = 'PRXBI_DW'
      AND O.OBJECT_NAME = T.TABLE_NAME
      AND O.OBJECT_TYPE = 'TABLE'
      AND O.OWNER = T.OWNER
      AND KC.OBJECT_TYPE = 'TABLE'
      AND KC.NAME = T.TABLE_NAME
      AND KC.OWNER = T.OWNER
      AND C.TABLE_NAME = KC.NAME
      AND C.COLUMN_NAME = KC.COLUMN_NAME
      AND C.OWNER = T.OWNER
     )
    WHERE ROWNUM = 1
   ) S
  ON (PT.TABLE_NAME = S.TABLE_NAME)
  WHEN MATCHED THEN
    UPDATE SET
      PT.PARTITIONING_TYPE = S.PARTITIONING_TYPE,
      PT.INTERVAL = CASE WHEN PT.PARTITIONING_TYPE = S.PARTITIONING_TYPE AND PT.KEY_COLUMN_NAME = S.KEY_COLUMN_NAME
                         THEN NVL(S.INTERVAL, PT.INTERVAL)
                         ELSE S.INTERVAL
                    END,
      PT.INTERVAL_CURRENT = S.INTERVAL,
      PT.SUBPARTITIONING_TYPE = S.SUBPARTITIONING_TYPE,
      PT.KEY_COLUMN_NAME = S.KEY_COLUMN_NAME,
      PT.KEY_COLUMN_DATA_TYPE = S.KEY_COLUMN_DATA_TYPE,
      PT.KEY_COLUMN_EXPRESSION = S.KEY_COLUMN_EXPRESSION,
      PT.NUMBER_OF_PARTITIONS = S.NUMBER_OF_PARTITIONS,
      PT.NEXT_POWER_OF_TWO = S.NEXT_POWER_OF_TWO,
      PT.LAST_DDL_TIME = S.LAST_DDL_TIME,
      PT.W_UPDATE_DT = SYSDATE,
      PT.ETL_PROC_WID = #BIAPPS.ETL_PROC_WID,
      PT.LOAD_PLAN_ID = #BIAPPS.EXECUTION_ID,
      PT.NUM_ROWS=S.NUM_ROWS
  WHEN NOT MATCHED THEN 
    INSERT
     (PT.TABLE_NAME,
      PT.PARTITIONING_TYPE,
      PT.INTERVAL,
      PT.INTERVAL_CURRENT,
      PT.SUBPARTITIONING_TYPE,
      PT.KEY_COLUMN_NAME,
      PT.KEY_COLUMN_DATA_TYPE,
      PT.KEY_COLUMN_EXPRESSION,
      PT.NUMBER_OF_PARTITIONS,
      PT.NEXT_POWER_OF_TWO,
      PT.LAST_DDL_TIME,
      PT.CREATED,
      PT.W_INSERT_DT,
      PT.W_UPDATE_DT,
      PT.ETL_PROC_WID,
      PT.LOAD_PLAN_ID,
      PT.INCR_NUM_ROWS, 
      PT.NUM_ROWS)
     VALUES
     (S.TABLE_NAME,
      S.PARTITIONING_TYPE,
      S.INTERVAL,
      S.INTERVAL,
      S.SUBPARTITIONING_TYPE,
      S.KEY_COLUMN_NAME,
      S.KEY_COLUMN_DATA_TYPE,
      S.KEY_COLUMN_EXPRESSION,
      S.NUMBER_OF_PARTITIONS,
      S.NEXT_POWER_OF_TWO,
      S.LAST_DDL_TIME,
      S.CREATED,
      SYSDATE,
      SYSDATE,
      #BIAPPS.ETL_PROC_WID,
      #BIAPPS.EXECUTION_ID,
      S.INCR_NUM_ROWS,  
      S.NUM_ROWS)",0,0,0,0
"Procedure","Load Partition Metadata",7,0,"D","","BIAPPS_DW","","DECLARE

  CURSOR part_csr IS
  SELECT count(*)
  FROM ALL_PART_TABLES t
  WHERE t.TABLE_NAME = 'W_GL_BALANCE_F'
  AND t.OWNER = 'PRXBI_DW';

  l_part_ind  NUMBER;

BEGIN

/* Delete obsolete table partitions */
  DELETE FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS T
  WHERE T.TABLE_NAME = 'W_GL_BALANCE_F'
  AND NOT EXISTS
   (SELECT 1 FROM ALL_TAB_PARTITIONS P
    WHERE P.TABLE_OWNER = 'PRXBI_DW'
    AND P.TABLE_NAME = T.TABLE_NAME
    AND P.PARTITION_NAME = T.PARTITION_NAME);

/* Delete obsolete index partitions */
  DELETE FROM PRXBI_DW.W_ETL_PART_INDEX_PARTS I
  WHERE I.TABLE_NAME = 'W_GL_BALANCE_F'
  AND NOT EXISTS
   (SELECT 1 FROM ALL_IND_PARTITIONS P
    WHERE P.INDEX_OWNER = 'PRXBI_DW'
    AND P.INDEX_NAME = I.INDEX_NAME
    AND P.PARTITION_NAME = I.INDEX_PARTITION_NAME);

/* Delete all partition metadata if table is no longer partitioned */
  OPEN part_csr;
  FETCH part_csr INTO l_part_ind;
  CLOSE part_csr;

  IF l_part_ind = 0 THEN
  
    DELETE FROM PRXBI_DW.W_ETL_PART_TABLES
    WHERE TABLE_NAME = 'W_GL_BALANCE_F';

    DELETE FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS
    WHERE TABLE_NAME = 'W_GL_BALANCE_F';

    DELETE FROM PRXBI_DW.W_ETL_PART_INDEX_PARTS
    WHERE TABLE_NAME = 'W_GL_BALANCE_F';

  END IF;

END;",0,0,0,0
"Procedure","Load Partition Metadata",9,3,"D","","BIAPPS_DW","","BEGIN

/* Refresh table partitions */
MERGE INTO PRXBI_DW.W_ETL_PART_TABLE_PARTS PTP
  USING
   (SELECT
     TABLE_NAME
    ,PARTITION_NAME
    ,INTERVAL_GENERATED
    ,HIGH_VALUE
    ,CASE WHEN KEY_COLUMN_DATA_TYPE = 'NUMBER' AND PARTITIONING_TYPE <> 'LIST'
          THEN TO_NUMBER(HIGH_VALUE)
     END  HIGH_VALUE_NUMBER
    ,CASE WHEN KEY_COLUMN_DATA_TYPE = 'DATE' AND PARTITIONING_TYPE <> 'LIST'
          THEN PRXBI_DW.OBIA_PARTITION_2625555.GET_DATE_EXPR(HIGH_VALUE)
     END  HIGH_VALUE_DATE
    ,CREATED
    ,LAST_DDL_TIME
    ,INCR_NUM_ROWS
    ,NUM_ROWS
    FROM
     (SELECT
       T.TABLE_NAME,
       P.PARTITION_NAME,
       P.INTERVAL INTERVAL_GENERATED,
       T.KEY_COLUMN_DATA_TYPE,
       CASE WHEN T.PARTITIONING_TYPE = 'HASH'
            THEN TO_CHAR(P.PARTITION_POSITION)
            ELSE PRXBI_DW.OBIA_PARTITION_2625555.GET_HIGH_VALUE(P.TABLE_OWNER, P.TABLE_NAME, P.PARTITION_NAME)
       END  HIGH_VALUE,
       O.CREATED,
       O.LAST_DDL_TIME,
       T.PARTITIONING_TYPE,
       0 INCR_NUM_ROWS,
       P.NUM_ROWS
      FROM
       ALL_OBJECTS O,
       PRXBI_DW.W_ETL_PART_TABLES T,
       ALL_TAB_PARTITIONS P
      WHERE O.OWNER = 'PRXBI_DW'
      AND O.OBJECT_TYPE = 'TABLE PARTITION'
      AND O.OBJECT_NAME = 'W_GL_BALANCE_F'
      AND T.TABLE_NAME = O.OBJECT_NAME
      AND P.TABLE_OWNER = O.OWNER
      AND P.TABLE_NAME = O.OBJECT_NAME
      AND P.PARTITION_NAME = O.SUBOBJECT_NAME

     AND O.LAST_DDL_TIME > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')

     )
   ) S
  ON (PTP.TABLE_NAME = S.TABLE_NAME AND PTP.PARTITION_NAME = S.PARTITION_NAME)
  WHEN MATCHED THEN
    UPDATE SET
     PTP.INTERVAL_GENERATED = S.INTERVAL_GENERATED,
     PTP.HIGH_VALUE = S.HIGH_VALUE,
     PTP.HIGH_VALUE_NUMBER = S.HIGH_VALUE_NUMBER,
     PTP.HIGH_VALUE_DATE = S.HIGH_VALUE_DATE,
     PTP.LAST_DDL_TIME = S.LAST_DDL_TIME,
     PTP.W_UPDATE_DT = SYSDATE,
     PTP.ETL_PROC_WID = #BIAPPS.ETL_PROC_WID,
     PTP.LOAD_PLAN_ID = #BIAPPS.EXECUTION_ID,
     PTP.NUM_ROWS= S.NUM_ROWS
  WHEN NOT MATCHED THEN
    INSERT
     (PTP.TABLE_NAME,
      PTP.PARTITION_NAME,
      PTP.INTERVAL_GENERATED,
      PTP.HIGH_VALUE,
      PTP.HIGH_VALUE_NUMBER,
      PTP.HIGH_VALUE_DATE,
      PTP.CREATED,
      PTP.LAST_DDL_TIME,
      PTP.W_INSERT_DT,
      PTP.W_UPDATE_DT,
      PTP.ETL_PROC_WID,
      PTP.LOAD_PLAN_ID,
      PTP.INCR_NUM_ROWS,
      PTP.NUM_ROWS)
     VALUES
     (S.TABLE_NAME,
      S.PARTITION_NAME,
      S.INTERVAL_GENERATED,
      S.HIGH_VALUE,
      S.HIGH_VALUE_NUMBER,
      S.HIGH_VALUE_DATE,
      S.CREATED,
      S.LAST_DDL_TIME,
      SYSDATE,
      SYSDATE,
      #BIAPPS.ETL_PROC_WID,
      #BIAPPS.EXECUTION_ID,
      S.INCR_NUM_ROWS,
      S.NUM_ROWS);

/* Refresh Index Partitions */
MERGE INTO PRXBI_DW.W_ETL_PART_INDEX_PARTS PIP
  USING
   (SELECT
     PI.INDEX_NAME
    ,PI.INDEX_PARTITION_NAME
    ,PI.TABLE_NAME
    ,PT.PARTITION_NAME TABLE_PARTITION_NAME
    ,PI.INTERVAL_GENERATED
    ,PI.HIGH_VALUE
    ,PT.HIGH_VALUE_NUMBER
    ,PT.HIGH_VALUE_DATE
    ,PI.CREATED
    ,PI.LAST_DDL_TIME
    FROM
     PRXBI_DW.W_ETL_PART_TABLE_PARTS PT,
     (SELECT /*+ NO_MERGE ORDERED */
       I.INDEX_NAME,
       I.TABLE_NAME,
       IP.PARTITION_NAME INDEX_PARTITION_NAME,
       IP.INTERVAL INTERVAL_GENERATED,
       CASE WHEN T.PARTITIONING_TYPE = 'HASH'
            THEN TO_CHAR(IP.PARTITION_POSITION)
            ELSE PRXBI_DW.OBIA_PARTITION_2625555.GET_INDEX_HIGH_VALUE(IP.INDEX_OWNER, IP.INDEX_NAME, IP.PARTITION_NAME)
       END  HIGH_VALUE,
       O.CREATED,
       O.LAST_DDL_TIME
      FROM
       ALL_INDEXES I,
       ALL_OBJECTS O,
       ALL_IND_PARTITIONS IP,
       PRXBI_DW.W_ETL_PART_TABLES T
      WHERE I.OWNER = 'PRXBI_DW'
      AND I.TABLE_NAME = 'W_GL_BALANCE_F'
      AND O.OWNER = I.OWNER
      AND O.OBJECT_TYPE = 'INDEX PARTITION'
      AND O.OBJECT_NAME = I.INDEX_NAME
      AND IP.INDEX_NAME = O.OBJECT_NAME
      AND IP.INDEX_OWNER = O.OWNER
      AND IP.PARTITION_NAME = O.SUBOBJECT_NAME
      AND T.TABLE_NAME = I.TABLE_NAME

      AND O.LAST_DDL_TIME > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')

     ) PI
    WHERE PT.TABLE_NAME = PI.TABLE_NAME
    AND PT.HIGH_VALUE = PI.HIGH_VALUE 
   ) S
  ON (PIP.INDEX_NAME = S.INDEX_NAME AND PIP.INDEX_PARTITION_NAME = S.INDEX_PARTITION_NAME)
  WHEN MATCHED THEN
    UPDATE SET
      PIP.TABLE_NAME = S.TABLE_NAME,
	    PIP.TABLE_PARTITION_NAME = S.TABLE_PARTITION_NAME,
	    PIP.INTERVAL_GENERATED = S.INTERVAL_GENERATED,
	    PIP.HIGH_VALUE = S.HIGH_VALUE,
	    PIP.HIGH_VALUE_NUMBER = S.HIGH_VALUE_NUMBER,
	    PIP.HIGH_VALUE_DATE = S.HIGH_VALUE_DATE,
	    PIP.LAST_DDL_TIME = S.LAST_DDL_TIME,
	    PIP.W_UPDATE_DT = SYSDATE,
	    PIP.ETL_PROC_WID = #BIAPPS.ETL_PROC_WID,
	    PIP.LOAD_PLAN_ID = #BIAPPS.EXECUTION_ID
  WHEN NOT MATCHED THEN
    INSERT
     (PIP.INDEX_NAME,
	    PIP.TABLE_NAME,
	    PIP.INDEX_PARTITION_NAME,
	    PIP.TABLE_PARTITION_NAME,
	    PIP.INTERVAL_GENERATED,
	    PIP.HIGH_VALUE,
	    PIP.HIGH_VALUE_NUMBER,
	    PIP.HIGH_VALUE_DATE,
	    PIP.CREATED,
	    PIP.LAST_DDL_TIME,
	    PIP.W_INSERT_DT,
	    PIP.W_UPDATE_DT,
	    PIP.ETL_PROC_WID,
	    PIP.LOAD_PLAN_ID)
     VALUES
     (S.INDEX_NAME,
	    S.TABLE_NAME,
	    S.INDEX_PARTITION_NAME,
	    S.TABLE_PARTITION_NAME,
	    S.INTERVAL_GENERATED,
	    S.HIGH_VALUE,
	    S.HIGH_VALUE_NUMBER,
	    S.HIGH_VALUE_DATE,
	    S.CREATED,
	    S.LAST_DDL_TIME,
	    SYSDATE,
	    SYSDATE,
	    #BIAPPS.ETL_PROC_WID,
	    #BIAPPS.EXECUTION_ID);

/* Sets numeric Low Values to previous record's High Value */
UPDATE PRXBI_DW.W_ETL_PART_TABLE_PARTS T
SET T.LOW_VALUE_NUMBER =
 (SELECT MAX(X.HIGH_VALUE_NUMBER)
  FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS X
  WHERE X.HIGH_VALUE_NUMBER < T.HIGH_VALUE_NUMBER
  AND X.TABLE_NAME = T.TABLE_NAME)
WHERE T.TABLE_NAME = 'W_GL_BALANCE_F'

AND T.HIGH_VALUE_NUMBER >=
 (SELECT MIN(T2.HIGH_VALUE_NUMBER)
  FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS T2
  WHERE T2.TABLE_NAME = 'W_GL_BALANCE_F'
  AND T2.ETL_PROC_WID = #BIAPPS.ETL_PROC_WID)

AND T.HIGH_VALUE_NUMBER IS NOT NULL;

/* Sets date Low Values to previous record's High Value */
UPDATE PRXBI_DW.W_ETL_PART_TABLE_PARTS T
SET T.LOW_VALUE_DATE =
 (SELECT MAX(X.HIGH_VALUE_DATE)
  FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS X
  WHERE X.HIGH_VALUE_DATE < T.HIGH_VALUE_DATE
  AND X.TABLE_NAME = T.TABLE_NAME)
WHERE T.TABLE_NAME = 'W_GL_BALANCE_F'

AND T.HIGH_VALUE_DATE >=
 (SELECT MIN(T2.HIGH_VALUE_DATE)
  FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS T2
  WHERE T2.TABLE_NAME = 'W_GL_BALANCE_F'
  AND T2.ETL_PROC_WID = #BIAPPS.ETL_PROC_WID)

AND T.HIGH_VALUE_DATE IS NOT NULL;

/* Update interval start ranges */
UPDATE PRXBI_DW.W_ETL_PART_TABLES T
SET (T.INTERVAL_START_NUMBER, T.INTERVAL_START_DATE) =
 (SELECT MAX(P.HIGH_VALUE_NUMBER), MAX(P.HIGH_VALUE_DATE)
  FROM PRXBI_DW.W_ETL_PART_TABLE_PARTS P
  WHERE P.INTERVAL_GENERATED = 'NO'
  AND P.TABLE_NAME = T.TABLE_NAME)
WHERE T.INTERVAL IS NOT NULL
AND T.PARTITIONING_TYPE = 'RANGE'
AND T.TABLE_NAME = 'W_GL_BALANCE_F';

/* Drop old index partitions */
DELETE FROM PRXBI_DW.W_ETL_PART_INDEX_PARTS I
WHERE I.ROWID IN
 (SELECT I2.ROWID
  FROM PRXBI_DW.W_ETL_PART_INDEX_PARTS I2, PRXBI_DW.W_ETL_PART_INDEX_PARTS I3
  WHERE I2.INDEX_NAME = I3.INDEX_NAME
  AND I2.HIGH_VALUE = I3.HIGH_VALUE
  AND I2.LAST_DDL_TIME < I3.LAST_DDL_TIME
  AND I2.TABLE_NAME = 'W_GL_BALANCE_F');

END;",0,0,0,0
"SERIAL","MAP_MAIN",10,847,"M","","","","",0,686,0,0
"Variable","DIAG_EXEC_NUMBER",10,847,"M","","","","",0,686,0,0
"SERIAL","EU",20,847,"M","","","","",0,686,0,0
"Alter Session - Char Semantics","IKM BIAPPS Oracle Fact Incremental Update",50,0,"D","BIAPPS_DW","BIAPPS_DW","","

/* Below statement ensure table lengths are proper for Oracle Unicode Enabled DBs.
 */
BEGIN
EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT=''DD/MON/YYYY HH24:MI:SS''';
EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_LENGTH_SEMANTICS=CHAR'  ; 
END;

  ",0,0,0,0
"Initialization and log header","IKM BIAPPS Oracle Fact Incremental Update",30,0,"D","BIAPPS_DW","BIAPPS_DW","","/* ===================================================
--  IKM BIAPPS Fact Oracle Incremental Update 
--  11.1.1.11.1.20170611 
-- ===================================================
---------------------------------------------------
KM Options and Behaviour
---------------------------------------------------
Uses Change Indicator:		Y
DATASOURCE_NUM_ID column is part of the Unique Key
ROW_WID column present:	N
Bulk Mode Option:		N
DELETE_FLG column present:	N
Error Logging Option:		N
Setting error table name to E$_2625555_5
Error Logging Supported:		Y
Is this a Dim ETL:		N
Auto Correction Enabled:		Y
Bypass Flow Table:		N
Target Type:			OTHER 
---------------------------------------------------
Work Objects
---------------------------------------------------
Setting flow table name to PRXBI_DW.I$_2625555_5 
---------------------------------------------------
Partition Information
---------------------------------------------------
Table partitioned:	N

=================================================== */   ",0,0,0,0
"Run Alter Session Commands","IKM BIAPPS Oracle Fact Incremental Update",40,0,"D","BIAPPS_DW","BIAPPS_DW","","BEGIN

  NULL; 
END;   ",0,0,0,0
"Truncate table","IKM BIAPPS Oracle Fact Incremental Update",90,0,"D","BIAPPS_DW","BIAPPS_DW","","

/* Table only truncated in full load */

  ",0,0,0,0
"Drop flow table","IKM BIAPPS Oracle Fact Incremental Update",100,0,"M","BIAPPS_DW","BIAPPS_DW","","

drop table PRXBI_DW.I$_2625555_5 purge  ",0,0,0,0
"Drop part table","IKM BIAPPS Oracle Fact Incremental Update",110,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
 ",0,0,0,0
"Diagnostics - Drop Error Table","IKM BIAPPS Oracle Fact Incremental Update",60,0,"M","BIAPPS_DW","BIAPPS_DW",""," drop table  PRXBI_DW.E$_2625555_5  purge    ",0,0,0,0
"Diagnostics - Create Error Table","IKM BIAPPS Oracle Fact Incremental Update",70,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Creates the error table during Error Logging Mode */
CREATE TABLE PRXBI_DW.E$_2625555_5
( 
	ORA_ERR_NUMBER$		NUMBER,         
	ORA_ERR_MESG$		VARCHAR2(2000),
	ORA_ERR_ROWID$		UROWID,
	ORA_ERR_OPTYP$		VARCHAR2(2),
	ORA_ERR_TAG$		VARCHAR2(2000),
	IND_UPDATE			VARCHAR2(10),
	DIAGNOSTIC_ROWID		UROWID,
	ERROR_TYPE_IND		VARCHAR2(100),	
	AUTOCORRECT_IND		VARCHAR2(100)  DEFAULT 'N',
	AUTOCORRECT_CODE		VARCHAR2(2000),
	AUTOCORRECT_DESC		VARCHAR2(2000),
	COMMITTED			VARCHAR2(10) DEFAULT '0',
	LEDGER_WID		 VARCHAR2(4000),
	 COST_CENTER_WID		 VARCHAR2(4000),
	 PROFIT_CENTER_WID		 VARCHAR2(4000),
	 BALANCING_SEGMENT_WID		 VARCHAR2(4000),
	 NATURAL_ACCOUNT_WID		 VARCHAR2(4000),
	 COMPANY_ORG_WID		 VARCHAR2(4000),
	 BUSN_AREA_ORG_WID		 VARCHAR2(4000),
	 GL_ACCOUNT_WID		 VARCHAR2(4000),
	 BALANCE_DT_WID		 VARCHAR2(4000),
	 BALANCE_TM_WID		 VARCHAR2(4000),
	 TREASURY_SYMBOL_WID		 VARCHAR2(4000),
	 MCAL_CAL_WID		 VARCHAR2(4000),
	 GL_DATASET_SEC_WID		 VARCHAR2(4000),
	 DB_CR_IND		 VARCHAR2(4000),
	 BALANCE_ACCT_AMT		 VARCHAR2(4000),
	 BALANCE_LOC_AMT		 VARCHAR2(4000),
	 BALANCE_GLOBAL1_AMT		 VARCHAR2(4000),
	 BALANCE_GLOBAL2_AMT		 VARCHAR2(4000),
	 BALANCE_GLOBAL3_AMT		 VARCHAR2(4000),
	 ACTIVITY_ACCT_AMT		 VARCHAR2(4000),
	 ACTIVITY_LOC_AMT		 VARCHAR2(4000),
	 ACTIVITY_GLOBAL1_AMT		 VARCHAR2(4000),
	 ACTIVITY_GLOBAL2_AMT		 VARCHAR2(4000),
	 ACTIVITY_GLOBAL3_AMT		 VARCHAR2(4000),
	 ACCT_CURR_CODE		 VARCHAR2(4000),
	 LOC_CURR_CODE		 VARCHAR2(4000),
	 W_INSERT_DT		 VARCHAR2(4000),
	 W_UPDATE_DT		 VARCHAR2(4000),
	 INTEGRATION_ID		 VARCHAR2(4000),
	 DATASOURCE_NUM_ID		 VARCHAR2(4000),
	 ETL_PROC_WID		 VARCHAR2(4000),
	 TENANT_ID		 VARCHAR2(4000),
	 X_CUSTOM		 VARCHAR2(4000),
	 BALANCE_TYPE_FLAG		 VARCHAR2(4000),
	 TRANSLATED_FLAG		 VARCHAR2(4000),
	 SUMMARY_ACCOUNT_FLAG		 VARCHAR2(4000),
	 CREATED_ON_DT		 VARCHAR2(4000),
	 CHANGED_ON_DT		 VARCHAR2(4000),
	 AUX1_CHANGED_ON_DT		 VARCHAR2(4000),
	 AUX2_CHANGED_ON_DT		 VARCHAR2(4000),
	 AUX3_CHANGED_ON_DT		 VARCHAR2(4000),
	 AUX4_CHANGED_ON_DT		 VARCHAR2(4000),
	 GL_SEGMENT1_WID		 VARCHAR2(4000),
	 GL_SEGMENT2_WID		 VARCHAR2(4000),
	 GL_SEGMENT3_WID		 VARCHAR2(4000),
	 GL_SEGMENT4_WID		 VARCHAR2(4000),
	 GL_SEGMENT5_WID		 VARCHAR2(4000),
	 GL_SEGMENT6_WID		 VARCHAR2(4000),
	 GL_SEGMENT7_WID		 VARCHAR2(4000),
	 GL_SEGMENT8_WID		 VARCHAR2(4000),
	 GL_SEGMENT9_WID		 VARCHAR2(4000),
	 GL_SEGMENT10_WID		 VARCHAR2(4000),
	 BUDGET_PERIOD_WID		 VARCHAR2(4000),
	 BALANCE_TYPE_WID		 VARCHAR2(4000),
	 CARRY_FORWARD_ACCT_AMT		 VARCHAR2(4000),
	 CARRY_FORWARD_LOC_AMT		 VARCHAR2(4000),
	 CARRY_FORWARD_GLOBAL1_AMT		 VARCHAR2(4000),
	 CARRY_FORWARD_GLOBAL2_AMT		 VARCHAR2(4000),
	 CARRY_FORWARD_GLOBAL3_AMT		 VARCHAR2(4000),
	 FINANCIAL_GL_FLG		 VARCHAR2(4000),
	 BUDGETARY_CONTROL_FLG		 VARCHAR2(4000),
	 BALANCE_ID		 VARCHAR2(4000),
	 SEG_PROJECT_WID		 VARCHAR2(4000),
	 SEG_PROGRAM_WID		 VARCHAR2(4000),
	 BUDGET_LEDGER_WID		 VARCHAR2(4000),
	 BUDGET_MCAL_CAL_WID		 VARCHAR2(4000),
	 BUDGET_WID		 VARCHAR2(4000),
	 BALANCE_DT_KEY		 VARCHAR2(4000),
	 BUDGET_ACCOUNT_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT1_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT2_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT3_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT4_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT5_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT6_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT7_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT8_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT9_WID		 VARCHAR2(4000),
	 BUDGET_SEGMENT10_WID		 VARCHAR2(4000),
	 X_SEGMENT1_CODE		 VARCHAR2(4000),
	 X_SEGMENT2_CODE		 VARCHAR2(4000),
	 X_SEGMENT3_CODE		 VARCHAR2(4000),
	 X_SEGMENT4_CODE		 VARCHAR2(4000),
	 X_SEGMENT5_CODE		 VARCHAR2(4000),
	 X_SEGMENT6_CODE		 VARCHAR2(4000),
	 X_SEGMENT7_CODE		 VARCHAR2(4000),
	 X_SEGMENT8_CODE		 VARCHAR2(4000),
	 X_SEGMENT9_CODE		 VARCHAR2(4000),
	 X_TS_YEAR_WID		 VARCHAR2(4000),
	 X_TS_PERIOD_WID		 VARCHAR2(4000),
	 X_TS_DATE_WID		 VARCHAR2(4000),
	DELETE_FLG			VARCHAR2(4000)
) NOLOGGING
  ",0,0,0,0
"Validate KM options","IKM BIAPPS Oracle Fact Incremental Update",80,0,"D","BIAPPS_DW","BIAPPS_DW","","# Validating KM options
  ",0,0,0,0
"Create flow table I$","IKM BIAPPS Oracle Fact Incremental Update",120,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Creates the flow table with the parameters specified in the FLOW_TABLE_OPTIONS option */
create table PRXBI_DW.I$_2625555_5
(
	INTEGRATION_ID		VARCHAR2(320 CHAR) NULL,
	DATASOURCE_NUM_ID		NUMBER(10,0) NULL,
	LEDGER_WID		NUMBER NULL,
	COST_CENTER_WID		NUMBER NULL,
	PROFIT_CENTER_WID		NUMBER NULL,
	BALANCING_SEGMENT_WID		NUMBER NULL,
	NATURAL_ACCOUNT_WID		NUMBER NULL,
	COMPANY_ORG_WID		NUMBER NULL,
	BUSN_AREA_ORG_WID		NUMBER NULL,
	GL_ACCOUNT_WID		NUMBER NULL,
	BALANCE_DT_WID		NUMBER NULL,
	BALANCE_TM_WID		NUMBER NULL,
	TREASURY_SYMBOL_WID		NUMBER NULL,
	MCAL_CAL_WID		NUMBER NULL,
	GL_DATASET_SEC_WID		NUMBER NULL,
	DB_CR_IND		VARCHAR2(4000) NULL,
	BALANCE_ACCT_AMT		NUMBER NULL,
	BALANCE_LOC_AMT		NUMBER NULL,
	BALANCE_GLOBAL1_AMT		NUMBER NULL,
	BALANCE_GLOBAL2_AMT		NUMBER NULL,
	BALANCE_GLOBAL3_AMT		NUMBER NULL,
	ACTIVITY_ACCT_AMT		NUMBER NULL,
	ACTIVITY_LOC_AMT		NUMBER NULL,
	ACTIVITY_GLOBAL1_AMT		NUMBER NULL,
	ACTIVITY_GLOBAL2_AMT		NUMBER NULL,
	ACTIVITY_GLOBAL3_AMT		NUMBER NULL,
	ACCT_CURR_CODE		VARCHAR2(4000) NULL,
	LOC_CURR_CODE		VARCHAR2(4000) NULL,
	W_INSERT_DT		DATE NULL,
	W_UPDATE_DT		DATE NULL,
	ETL_PROC_WID		NUMBER NULL,
	TENANT_ID		VARCHAR2(4000) NULL,
	X_CUSTOM		VARCHAR2(4000) NULL,
	BALANCE_TYPE_FLAG		VARCHAR2(4000) NULL,
	TRANSLATED_FLAG		VARCHAR2(4000) NULL,
	SUMMARY_ACCOUNT_FLAG		VARCHAR2(4000) NULL,
	CREATED_ON_DT		DATE NULL,
	CHANGED_ON_DT		DATE NULL,
	AUX1_CHANGED_ON_DT		DATE NULL,
	AUX2_CHANGED_ON_DT		DATE NULL,
	AUX3_CHANGED_ON_DT		DATE NULL,
	AUX4_CHANGED_ON_DT		DATE NULL,
	GL_SEGMENT1_WID		NUMBER NULL,
	GL_SEGMENT2_WID		NUMBER NULL,
	GL_SEGMENT3_WID		NUMBER NULL,
	GL_SEGMENT4_WID		NUMBER NULL,
	GL_SEGMENT5_WID		NUMBER NULL,
	GL_SEGMENT6_WID		NUMBER NULL,
	GL_SEGMENT7_WID		NUMBER NULL,
	GL_SEGMENT8_WID		NUMBER NULL,
	GL_SEGMENT9_WID		NUMBER NULL,
	GL_SEGMENT10_WID		NUMBER NULL,
	BUDGET_PERIOD_WID		NUMBER NULL,
	BALANCE_TYPE_WID		NUMBER NULL,
	CARRY_FORWARD_ACCT_AMT		NUMBER NULL,
	CARRY_FORWARD_LOC_AMT		NUMBER NULL,
	CARRY_FORWARD_GLOBAL1_AMT		NUMBER NULL,
	CARRY_FORWARD_GLOBAL2_AMT		NUMBER NULL,
	CARRY_FORWARD_GLOBAL3_AMT		NUMBER NULL,
	FINANCIAL_GL_FLG		VARCHAR2(4000) NULL,
	BUDGETARY_CONTROL_FLG		VARCHAR2(4000) NULL,
	BALANCE_ID		VARCHAR2(4000) NULL,
	SEG_PROJECT_WID		NUMBER NULL,
	SEG_PROGRAM_WID		NUMBER NULL,
	BUDGET_LEDGER_WID		NUMBER NULL,
	BUDGET_MCAL_CAL_WID		NUMBER NULL,
	BUDGET_WID		NUMBER NULL,
	BALANCE_DT_KEY		NUMBER NULL,
	BUDGET_ACCOUNT_WID		NUMBER NULL,
	BUDGET_SEGMENT1_WID		NUMBER NULL,
	BUDGET_SEGMENT2_WID		NUMBER NULL,
	BUDGET_SEGMENT3_WID		NUMBER NULL,
	BUDGET_SEGMENT4_WID		NUMBER NULL,
	BUDGET_SEGMENT5_WID		NUMBER NULL,
	BUDGET_SEGMENT6_WID		NUMBER NULL,
	BUDGET_SEGMENT7_WID		NUMBER NULL,
	BUDGET_SEGMENT8_WID		NUMBER NULL,
	BUDGET_SEGMENT9_WID		NUMBER NULL,
	BUDGET_SEGMENT10_WID		NUMBER NULL,
	X_SEGMENT1_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT2_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT3_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT4_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT5_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT6_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT7_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT8_CODE		VARCHAR2(4000) NULL,
	X_SEGMENT9_CODE		VARCHAR2(4000) NULL,
	X_TS_YEAR_WID		NUMBER NULL,
	X_TS_PERIOD_WID		NUMBER NULL,
	X_TS_DATE_WID		NUMBER NULL,
	IND_UPDATE		CHAR(1)
)
NOLOGGING
  ",0,0,0,0
"Create part table I$","IKM BIAPPS Oracle Fact Incremental Update",130,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
 ",0,0,0,0
"Insert flow into I$ table","IKM BIAPPS Oracle Fact Incremental Update",140,6,"D","BIAPPS_DW","BIAPPS_DW","","
/* Detection Strategy:  OUTER */
INSERT  /*+ append */   INTO PRXBI_DW.I$_2625555_5
(
LEDGER_WID,
 COST_CENTER_WID,
 BALANCING_SEGMENT_WID,
 NATURAL_ACCOUNT_WID,
 COMPANY_ORG_WID,
 BUSN_AREA_ORG_WID,
 GL_ACCOUNT_WID,
 BALANCE_DT_WID,
 BALANCE_TM_WID,
 TREASURY_SYMBOL_WID,
 MCAL_CAL_WID,
 GL_DATASET_SEC_WID,
 DB_CR_IND,
 BALANCE_ACCT_AMT,
 BALANCE_LOC_AMT,
 BALANCE_GLOBAL1_AMT,
 BALANCE_GLOBAL2_AMT,
 BALANCE_GLOBAL3_AMT,
 ACTIVITY_ACCT_AMT,
 ACTIVITY_LOC_AMT,
 ACTIVITY_GLOBAL1_AMT,
 ACTIVITY_GLOBAL2_AMT,
 ACTIVITY_GLOBAL3_AMT,
 ACCT_CURR_CODE,
 LOC_CURR_CODE,
 INTEGRATION_ID,
 DATASOURCE_NUM_ID,
 TENANT_ID,
 X_CUSTOM,
 BALANCE_TYPE_FLAG,
 TRANSLATED_FLAG,
 SUMMARY_ACCOUNT_FLAG,
 CREATED_ON_DT,
 CHANGED_ON_DT,
 AUX1_CHANGED_ON_DT,
 AUX2_CHANGED_ON_DT,
 AUX3_CHANGED_ON_DT,
 AUX4_CHANGED_ON_DT,
 GL_SEGMENT1_WID,
 GL_SEGMENT2_WID,
 GL_SEGMENT3_WID,
 GL_SEGMENT4_WID,
 GL_SEGMENT5_WID,
 GL_SEGMENT6_WID,
 GL_SEGMENT7_WID,
 GL_SEGMENT8_WID,
 GL_SEGMENT9_WID,
 GL_SEGMENT10_WID,
 BUDGET_PERIOD_WID,
 BALANCE_TYPE_WID,
 CARRY_FORWARD_ACCT_AMT,
 CARRY_FORWARD_LOC_AMT,
 CARRY_FORWARD_GLOBAL1_AMT,
 CARRY_FORWARD_GLOBAL2_AMT,
 CARRY_FORWARD_GLOBAL3_AMT,
 FINANCIAL_GL_FLG,
 BUDGETARY_CONTROL_FLG,
 BALANCE_ID,
 SEG_PROJECT_WID,
 SEG_PROGRAM_WID,
 BUDGET_LEDGER_WID,
 BUDGET_MCAL_CAL_WID,
 BUDGET_WID,
 BALANCE_DT_KEY,
 BUDGET_ACCOUNT_WID,
 BUDGET_SEGMENT1_WID,
 BUDGET_SEGMENT2_WID,
 BUDGET_SEGMENT3_WID,
 BUDGET_SEGMENT4_WID,
 BUDGET_SEGMENT5_WID,
 BUDGET_SEGMENT6_WID,
 BUDGET_SEGMENT7_WID,
 BUDGET_SEGMENT8_WID,
 BUDGET_SEGMENT9_WID,
 BUDGET_SEGMENT10_WID,
 X_SEGMENT1_CODE,
 X_SEGMENT2_CODE,
 X_SEGMENT3_CODE,
 X_SEGMENT4_CODE,
 X_SEGMENT5_CODE,
 X_SEGMENT6_CODE,
 X_SEGMENT7_CODE,
 X_SEGMENT8_CODE,
 X_SEGMENT9_CODE,
 X_TS_YEAR_WID,
 X_TS_PERIOD_WID,
 X_TS_DATE_WID,
IND_UPDATE
)
SELECT   
C.LEDGER_WID,
 C.COST_CENTER_WID,
 C.BALANCING_SEGMENT_WID,
 C.NATURAL_ACCOUNT_WID,
 C.COMPANY_ORG_WID,
 C.BUSN_AREA_ORG_WID,
 C.GL_ACCOUNT_WID,
 C.BALANCE_DT_WID,
 C.BALANCE_TM_WID,
 C.TREASURY_SYMBOL_WID,
 C.MCAL_CAL_WID,
 C.GL_DATASET_SEC_WID,
 C.DB_CR_IND,
 C.BALANCE_ACCT_AMT,
 C.BALANCE_LOC_AMT,
 C.BALANCE_GLOBAL1_AMT,
 C.BALANCE_GLOBAL2_AMT,
 C.BALANCE_GLOBAL3_AMT,
 C.ACTIVITY_ACCT_AMT,
 C.ACTIVITY_LOC_AMT,
 C.ACTIVITY_GLOBAL1_AMT,
 C.ACTIVITY_GLOBAL2_AMT,
 C.ACTIVITY_GLOBAL3_AMT,
 C.ACCT_CURR_CODE,
 C.LOC_CURR_CODE,
 C.INTEGRATION_ID,
 C.DATASOURCE_NUM_ID,
 C.TENANT_ID,
 C.X_CUSTOM,
 C.BALANCE_TYPE_FLAG,
 C.TRANSLATED_FLAG,
 C.SUMMARY_ACCOUNT_FLAG,
 C.CREATED_ON_DT,
 C.CHANGED_ON_DT,
 C.AUX1_CHANGED_ON_DT,
 C.AUX2_CHANGED_ON_DT,
 C.AUX3_CHANGED_ON_DT,
 C.AUX4_CHANGED_ON_DT,
 C.GL_SEGMENT1_WID,
 C.GL_SEGMENT2_WID,
 C.GL_SEGMENT3_WID,
 C.GL_SEGMENT4_WID,
 C.GL_SEGMENT5_WID,
 C.GL_SEGMENT6_WID,
 C.GL_SEGMENT7_WID,
 C.GL_SEGMENT8_WID,
 C.GL_SEGMENT9_WID,
 C.GL_SEGMENT10_WID,
 C.BUDGET_PERIOD_WID,
 C.BALANCE_TYPE_WID,
 C.CARRY_FORWARD_ACCT_AMT,
 C.CARRY_FORWARD_LOC_AMT,
 C.CARRY_FORWARD_GLOBAL1_AMT,
 C.CARRY_FORWARD_GLOBAL2_AMT,
 C.CARRY_FORWARD_GLOBAL3_AMT,
 C.FINANCIAL_GL_FLG,
 C.BUDGETARY_CONTROL_FLG,
 C.BALANCE_ID,
 C.SEG_PROJECT_WID,
 C.SEG_PROGRAM_WID,
 C.BUDGET_LEDGER_WID,
 C.BUDGET_MCAL_CAL_WID,
 C.BUDGET_WID,
 C.BALANCE_DT_KEY,
 C.BUDGET_ACCOUNT_WID,
 C.BUDGET_SEGMENT1_WID,
 C.BUDGET_SEGMENT2_WID,
 C.BUDGET_SEGMENT3_WID,
 C.BUDGET_SEGMENT4_WID,
 C.BUDGET_SEGMENT5_WID,
 C.BUDGET_SEGMENT6_WID,
 C.BUDGET_SEGMENT7_WID,
 C.BUDGET_SEGMENT8_WID,
 C.BUDGET_SEGMENT9_WID,
 C.BUDGET_SEGMENT10_WID,
 C.X_SEGMENT1_CODE,
 C.X_SEGMENT2_CODE,
 C.X_SEGMENT3_CODE,
 C.X_SEGMENT4_CODE,
 C.X_SEGMENT5_CODE,
 C.X_SEGMENT6_CODE,
 C.X_SEGMENT7_CODE,
 C.X_SEGMENT8_CODE,
 C.X_SEGMENT9_CODE,
 C.X_TS_YEAR_WID,
 C.X_TS_PERIOD_WID,
 C.X_TS_DATE_WID,
CASE
 WHEN T.ROWID IS NOT NULL

  AND NVL(T.CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))	 = NVL(C.CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))  AND NVL(T.AUX1_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))	 = NVL(C.AUX1_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))  AND NVL(T.AUX2_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))	 = NVL(C.AUX2_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))  AND NVL(T.AUX3_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))	 = NVL(C.AUX3_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))  AND NVL(T.AUX4_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))	 = NVL(C.AUX4_CHANGED_ON_DT,TO_DATE('01-01-3714', 'DD/MM/YYYY'))

 THEN 'N'
 WHEN T.ROWID IS NOT NULL
 THEN 'U'
 ELSE 'I'
END   IND_UPDATE
FROM
(
select    
   COALESCE((
SELECT 
  LKP_W_LEDGER_D_LKP_W_LEDGER_D.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_LEDGER_D_LKP_W_LEDGER_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_LEDGER_D_LKP_W_LEDGER_D.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_LEDGER_D_LKP_W_LEDGER_D.ROW_WID AS ROW_WID   
FROM 
  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_LEDGER_D_LKP_W_LEDGER_D.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_LEDGER_D_LKP_W_LEDGER_D.ROW_WID	AS ROW_WID,
	W_LEDGER_D_LKP_W_LEDGER_D.INTEGRATION_ID	AS INTEGRATION_ID
from	PRXBI_DW.W_LEDGER_D W_LEDGER_D_LKP_W_LEDGER_D
where	(1=1)
)  LKP_W_LEDGER_D_LKP_W_LEDGER_D  
  ) LKP_W_LEDGER_D_LKP_W_LEDGER_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_LEDGER_D_LKP_W_LEDGER_D.DATASOURCE_NUM_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LEDGER_ID = LKP_W_LEDGER_D_LKP_W_LEDGER_D.INTEGRATION_ID
) ),0)  AS LEDGER_WID,
	COALESCE((
SELECT 
  LKP_W_COST_CENTER_D_LKP_W_COST.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_COST_CENTER_D_LKP_W_COST.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_COST_CENTER_D_LKP_W_COST.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_COST_CENTER_D_LKP_W_COST.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_COST_CENTER_D_LKP_W_COST.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_COST_CENTER_D_LKP_W_COST.ROW_WID AS ROW_WID   
FROM 
  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_COST_CENTER_D_LKP_W_COST_CEN.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_COST_CENTER_D_LKP_W_COST_CEN.ROW_WID	AS ROW_WID,
	W_COST_CENTER_D_LKP_W_COST_CEN.INTEGRATION_ID	AS INTEGRATION_ID,
	W_COST_CENTER_D_LKP_W_COST_CEN.EFFECTIVE_TO_DT	AS EFFECTIVE_TO_DT,
	W_COST_CENTER_D_LKP_W_COST_CEN.EFFECTIVE_FROM_DT	AS EFFECTIVE_FROM_DT
from	PRXBI_DW.W_COST_CENTER_D W_COST_CENTER_D_LKP_W_COST_CEN
where	(1=1)
)  LKP_W_COST_CENTER_D_LKP_W_COST  
  ) LKP_W_COST_CENTER_D_LKP_W_COST  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_COST_CENTER_D_LKP_W_COST.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COST_CENTER_ID,SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COST_CENTER_ATTRIB || '~' || SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COST_CENTER_NUM) = LKP_W_COST_CENTER_D_LKP_W_COST.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE >= LKP_W_COST_CENTER_D_LKP_W_COST.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE < LKP_W_COST_CENTER_D_LKP_W_COST.EFFECTIVE_TO_DT
) ),0)  AS COST_CENTER_WID,
	COALESCE((
SELECT 
  LKP_W_BALANCING_SEGMENT_D_LKP_.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_BALANCING_SEGMENT_D_LKP_.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_BALANCING_SEGMENT_D_LKP_.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_BALANCING_SEGMENT_D_LKP_.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_BALANCING_SEGMENT_D_LKP_.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_BALANCING_SEGMENT_D_LKP_.ROW_WID AS ROW_WID   
FROM 
  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_BALANCING_SEGMENT_D_LKP_W_BA.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_BALANCING_SEGMENT_D_LKP_W_BA.ROW_WID	AS ROW_WID,
	W_BALANCING_SEGMENT_D_LKP_W_BA.INTEGRATION_ID	AS INTEGRATION_ID,
	W_BALANCING_SEGMENT_D_LKP_W_BA.EFFECTIVE_TO_DT	AS EFFECTIVE_TO_DT,
	W_BALANCING_SEGMENT_D_LKP_W_BA.EFFECTIVE_FROM_DT	AS EFFECTIVE_FROM_DT
from	PRXBI_DW.W_BALANCING_SEGMENT_D W_BALANCING_SEGMENT_D_LKP_W_BA
where	(1=1)
)  LKP_W_BALANCING_SEGMENT_D_LKP_  
  ) LKP_W_BALANCING_SEGMENT_D_LKP_  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_BALANCING_SEGMENT_D_LKP_.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCING_SEGMENT_ID,SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCING_SEGMENT_ATTRIB || '~' || SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCING_SEGMENT_NUM) = LKP_W_BALANCING_SEGMENT_D_LKP_.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE >= LKP_W_BALANCING_SEGMENT_D_LKP_.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE < LKP_W_BALANCING_SEGMENT_D_LKP_.EFFECTIVE_TO_DT
) ),0)  AS BALANCING_SEGMENT_WID,
	COALESCE((
SELECT 
  LKP_W_NATURAL_ACCOUNT_D_LKP_W_.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_NATURAL_ACCOUNT_D_LKP_W_.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_NATURAL_ACCOUNT_D_LKP_W_.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_NATURAL_ACCOUNT_D_LKP_W_.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_NATURAL_ACCOUNT_D_LKP_W_.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_NATURAL_ACCOUNT_D_LKP_W_.ROW_WID AS ROW_WID   
FROM 
  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_NATURAL_ACCOUNT_D_LKP_W_NATU.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_NATURAL_ACCOUNT_D_LKP_W_NATU.ROW_WID	AS ROW_WID,
	W_NATURAL_ACCOUNT_D_LKP_W_NATU.INTEGRATION_ID	AS INTEGRATION_ID,
	W_NATURAL_ACCOUNT_D_LKP_W_NATU.EFFECTIVE_TO_DT	AS EFFECTIVE_TO_DT,
	W_NATURAL_ACCOUNT_D_LKP_W_NATU.EFFECTIVE_FROM_DT	AS EFFECTIVE_FROM_DT
from	PRXBI_DW.W_NATURAL_ACCOUNT_D W_NATURAL_ACCOUNT_D_LKP_W_NATU
where	(1=1)
)  LKP_W_NATURAL_ACCOUNT_D_LKP_W_  
  ) LKP_W_NATURAL_ACCOUNT_D_LKP_W_  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_NATURAL_ACCOUNT_D_LKP_W_.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.NATURAL_ACCOUNT_ID,SQ_GL_BALANCES_FS_SQ_GL_BALA_1.NATURAL_ACCOUNT_ATTRIB || '~' || SQ_GL_BALANCES_FS_SQ_GL_BALA_1.NATURAL_ACCOUNT_NUM) = LKP_W_NATURAL_ACCOUNT_D_LKP_W_.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE >= LKP_W_NATURAL_ACCOUNT_D_LKP_W_.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE < LKP_W_NATURAL_ACCOUNT_D_LKP_W_.EFFECTIVE_TO_DT
) ),0)  AS NATURAL_ACCOUNT_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_28,0)  AS COMPANY_ORG_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUSN_AREA_ORG_WID,0)  AS BUSN_AREA_ORG_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.GL_ACCOUNT_WID,0)  AS GL_ACCOUNT_WID,
	COALESCE(CASE WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DT_WID IS NULL THEN
((CASE
WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE IS NULL OR 
CASE WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MCAL_CAL_WID IS NULL THEN
(
SELECT 
  LKP_W_MCAL_CONTEXT_G.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  (
SELECT 
  LKP_W_MCAL_CONTEXT_G.LEDGER_ID AS LEDGER_ID ,
  LKP_W_MCAL_CONTEXT_G.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_MCAL_CONTEXT_G.CONTEXT_CLASS AS CONTEXT_CLASS ,
  LKP_W_MCAL_CONTEXT_G.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  PRXBI_DW.W_MCAL_CONTEXT_G LKP_W_MCAL_CONTEXT_G  
  ) LKP_W_MCAL_CONTEXT_G  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COMPANY_ORG_ID||'~'||SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LEDGER_ID = LKP_W_MCAL_CONTEXT_G.LEDGER_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_MCAL_CONTEXT_G.DATASOURCE_NUM_ID
AND	LKP_W_MCAL_CONTEXT_G.CONTEXT_CLASS = 'GL'
) )
ELSE SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MCAL_CAL_WID
END IS NULL 
OR
SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ADJUSTMENT_FLAG IS NULL THEN NULL
ELSE TO_NUMBER(TO_CHAR(CASE WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MCAL_CAL_WID IS NULL THEN
(
SELECT 
  LKP_W_MCAL_CONTEXT_G.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  (
SELECT 
  LKP_W_MCAL_CONTEXT_G.LEDGER_ID AS LEDGER_ID ,
  LKP_W_MCAL_CONTEXT_G.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_MCAL_CONTEXT_G.CONTEXT_CLASS AS CONTEXT_CLASS ,
  LKP_W_MCAL_CONTEXT_G.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  PRXBI_DW.W_MCAL_CONTEXT_G LKP_W_MCAL_CONTEXT_G  
  ) LKP_W_MCAL_CONTEXT_G  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COMPANY_ORG_ID||'~'||SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LEDGER_ID = LKP_W_MCAL_CONTEXT_G.LEDGER_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_MCAL_CONTEXT_G.DATASOURCE_NUM_ID
AND	LKP_W_MCAL_CONTEXT_G.CONTEXT_CLASS = 'GL'
) )
ELSE SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MCAL_CAL_WID
END)
||
TO_CHAR(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE,'YYYYMMDD')
||
(CASE
WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ADJUSTMENT_FLAG='Y' THEN '999'
ELSE '000'
END ))
END ))
ELSE
SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DT_WID
END,0)  AS BALANCE_DT_WID,
	/* Format SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE to an integer using the format HH24MISS.  Default to 0 */
COALESCE(
	(CASE
WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE IS NULL THEN NULL
ELSE ROUND(TO_NUMBER(TO_CHAR(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE, 'HH24MISS')))
END ),
	0
)  AS BALANCE_TM_WID,
	COALESCE((
SELECT 
  LKP_W_TREASURY_SYMBOL_D_LKP_W_.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_TREASURY_SYMBOL_D_LKP_W_.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_TREASURY_SYMBOL_D_LKP_W_.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_TREASURY_SYMBOL_D_LKP_W_.ROW_WID AS ROW_WID   
FROM 
  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_TREASURY_SYMBOL_D_LKP_W_TREA.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_TREASURY_SYMBOL_D_LKP_W_TREA.ROW_WID	AS ROW_WID,
	W_TREASURY_SYMBOL_D_LKP_W_TREA.INTEGRATION_ID	AS INTEGRATION_ID
from	PRXBI_DW.W_TREASURY_SYMBOL_D W_TREASURY_SYMBOL_D_LKP_W_TREA
where	(1=1)
)  LKP_W_TREASURY_SYMBOL_D_LKP_W_  
  ) LKP_W_TREASURY_SYMBOL_D_LKP_W_  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_TREASURY_SYMBOL_D_LKP_W_.DATASOURCE_NUM_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCING_SEGMENT_NUM || '~' || SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCING_SEGMENT_ATTRIB || '~' || SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LEDGER_ID = LKP_W_TREASURY_SYMBOL_D_LKP_W_.INTEGRATION_ID
) ),0)  AS TREASURY_SYMBOL_WID,
	COALESCE(
CASE WHEN SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MCAL_CAL_WID IS NULL THEN
(
SELECT 
  LKP_W_MCAL_CONTEXT_G.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  (
SELECT 
  LKP_W_MCAL_CONTEXT_G.LEDGER_ID AS LEDGER_ID ,
  LKP_W_MCAL_CONTEXT_G.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_MCAL_CONTEXT_G.CONTEXT_CLASS AS CONTEXT_CLASS ,
  LKP_W_MCAL_CONTEXT_G.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  PRXBI_DW.W_MCAL_CONTEXT_G LKP_W_MCAL_CONTEXT_G  
  ) LKP_W_MCAL_CONTEXT_G  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COMPANY_ORG_ID||'~'||SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LEDGER_ID = LKP_W_MCAL_CONTEXT_G.LEDGER_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_MCAL_CONTEXT_G.DATASOURCE_NUM_ID
AND	LKP_W_MCAL_CONTEXT_G.CONTEXT_CLASS = 'GL'
) )
ELSE SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MCAL_CAL_WID
END,0)  AS MCAL_CAL_WID,
	COALESCE((
SELECT 
  LKP_W_GL_DATASET_SEC_D.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_GL_DATASET_SEC_D.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_GL_DATASET_SEC_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_GL_DATASET_SEC_D.ROW_WID AS ROW_WID   
FROM 
  PRXBI_DW.W_GL_DATASET_SEC_D LKP_W_GL_DATASET_SEC_D  
  ) LKP_W_GL_DATASET_SEC_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LEDGER_ID||'~'||SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCING_SEGMENT_NUM||'~'||SQ_GL_BALANCES_FS_SQ_GL_BALA_1.MANAGEMENT_SEGMENT_NUM = LKP_W_GL_DATASET_SEC_D.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_GL_DATASET_SEC_D.DATASOURCE_NUM_ID
) ),0)  AS GL_DATASET_SEC_WID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DB_CR_IND  AS DB_CR_IND,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_ACCT_AMT  AS BALANCE_ACCT_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_LOC_AMT  AS BALANCE_LOC_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL1_EXCH_RATE  AS BALANCE_GLOBAL1_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL2_EXCH_RATE  AS BALANCE_GLOBAL2_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL3_EXCH_RATE  AS BALANCE_GLOBAL3_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ACTIVITY_ACCT_AMT  AS ACTIVITY_ACCT_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ACTIVITY_LOC_AMT  AS ACTIVITY_LOC_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ACTIVITY_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL1_EXCH_RATE  AS ACTIVITY_GLOBAL1_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ACTIVITY_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL2_EXCH_RATE  AS ACTIVITY_GLOBAL2_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ACTIVITY_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL3_EXCH_RATE  AS ACTIVITY_GLOBAL3_AMT,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.ACCT_CURR_CODE,'__NOT_APPLICABLE__')  AS ACCT_CURR_CODE,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LOC_CURR_CODE,'__NOT_APPLICABLE__')  AS LOC_CURR_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.INTEGRATION_ID  AS INTEGRATION_ID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID  AS DATASOURCE_NUM_ID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.TENANT_ID  AS TENANT_ID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_CUSTOM  AS X_CUSTOM,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_TYPE_FLAG  AS BALANCE_TYPE_FLAG,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.TRANSLATED_FLAG  AS TRANSLATED_FLAG,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.SUMMARY_ACCOUNT_FLAG  AS SUMMARY_ACCOUNT_FLAG,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LAST_UPDATE_DATE  AS CREATED_ON_DT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LAST_UPDATE_DATE  AS CHANGED_ON_DT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.AUX1_CHANGED_ON_DT  AS AUX1_CHANGED_ON_DT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.AUX2_CHANGED_ON_DT  AS AUX2_CHANGED_ON_DT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.AUX3_CHANGED_ON_DT  AS AUX3_CHANGED_ON_DT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.AUX4_CHANGED_ON_DT  AS AUX4_CHANGED_ON_DT,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_59,0)  AS GL_SEGMENT1_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_56,0)  AS GL_SEGMENT2_WID,
	COALESCE((
SELECT 
  W_GL_SEGMENT_D3.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D3.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D3.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D3.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D3  
  ) W_GL_SEGMENT_D3  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.GL_SEGMENT3_ID=W_GL_SEGMENT_D3.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID=W_GL_SEGMENT_D3.DATASOURCE_NUM_ID
) ),0)  AS GL_SEGMENT3_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_53,0)  AS GL_SEGMENT4_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_50,0)  AS GL_SEGMENT5_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_47,0)  AS GL_SEGMENT6_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_44,0)  AS GL_SEGMENT7_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_41,0)  AS GL_SEGMENT8_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_38,0)  AS GL_SEGMENT9_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_35,0)  AS GL_SEGMENT10_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_PERIOD_WID,0)  AS BUDGET_PERIOD_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_TYPE_WID,0)  AS BALANCE_TYPE_WID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.CARRY_FORWARD_ACCT_AMT  AS CARRY_FORWARD_ACCT_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.CARRY_FORWARD_LOC_AMT  AS CARRY_FORWARD_LOC_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.CARRY_FORWARD_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL1_EXCH_RATE  AS CARRY_FORWARD_GLOBAL1_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.CARRY_FORWARD_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL2_EXCH_RATE  AS CARRY_FORWARD_GLOBAL2_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.CARRY_FORWARD_LOC_AMT * LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.GLBL3_EXCH_RATE  AS CARRY_FORWARD_GLOBAL3_AMT,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.FINANCIAL_GL_FLG  AS FINANCIAL_GL_FLG,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGETARY_CONTROL_FLG  AS BUDGETARY_CONTROL_FLG,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_ID  AS BALANCE_ID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_32,0)  AS SEG_PROJECT_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_29,0)  AS SEG_PROGRAM_WID,
	COALESCE((
SELECT 
  LKP_W_LEDGER_D_BUDGET_LEDGER.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  LKP_W_LEDGER_D_BUDGET_LEDGER.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_LEDGER_D_BUDGET_LEDGER.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_LEDGER_D_BUDGET_LEDGER.ROW_WID AS ROW_WID   
FROM 
  PRXBI_DW.W_LEDGER_D LKP_W_LEDGER_D_BUDGET_LEDGER  
  ) LKP_W_LEDGER_D_BUDGET_LEDGER  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_LEDGER_ID=LKP_W_LEDGER_D_BUDGET_LEDGER.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID=LKP_W_LEDGER_D_BUDGET_LEDGER.DATASOURCE_NUM_ID
) ),0)  AS BUDGET_LEDGER_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_MCAL_CAL_WID,0)  AS BUDGET_MCAL_CAL_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_WID,0)  AS BUDGET_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DT_WID_KEY,0)  AS BALANCE_DT_KEY,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_ACCOUNT_WID,0)  AS BUDGET_ACCOUNT_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_21,0)  AS BUDGET_SEGMENT1_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_18,0)  AS BUDGET_SEGMENT2_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_15,0)  AS BUDGET_SEGMENT3_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_12,0)  AS BUDGET_SEGMENT4_WID,
	COALESCE((
SELECT 
  W_BUDGET_SEGMENT_D5.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D5.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D5.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D5.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D5  
  ) W_BUDGET_SEGMENT_D5  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_SEGMENT5_ID=W_BUDGET_SEGMENT_D5.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D5.DATASOURCE_NUM_ID
) ),0)  AS BUDGET_SEGMENT5_WID,
	COALESCE((
SELECT 
  W_BUDGET_SEGMENT_D6.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D6.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D6.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D6.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D6  
  ) W_BUDGET_SEGMENT_D6  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BUDGET_SEGMENT6_ID=W_BUDGET_SEGMENT_D6.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D6.DATASOURCE_NUM_ID
) ),0)  AS BUDGET_SEGMENT6_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_9,0)  AS BUDGET_SEGMENT7_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_6,0)  AS BUDGET_SEGMENT8_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL_3,0)  AS BUDGET_SEGMENT9_WID,
	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.COL,0)  AS BUDGET_SEGMENT10_WID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT1_CODE  AS X_SEGMENT1_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT2_CODE  AS X_SEGMENT2_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT3_CODE  AS X_SEGMENT3_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT4_CODE  AS X_SEGMENT4_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT5_CODE  AS X_SEGMENT5_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT6_CODE  AS X_SEGMENT6_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT7_CODE  AS X_SEGMENT7_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT8_CODE  AS X_SEGMENT8_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_SEGMENT9_CODE  AS X_SEGMENT9_CODE,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_TS_YEAR_WID  AS X_TS_YEAR_WID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_TS_PERIOD_WID  AS X_TS_PERIOD_WID,
	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.X_TS_DATE_WID  AS X_TS_DATE_WID
from (
SELECT 
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT6_ID AS GL_SEGMENT6_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT2_ID AS GL_SEGMENT2_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT4_ID AS GL_SEGMENT4_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT9_ID AS GL_SEGMENT9_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT3_ID AS GL_SEGMENT3_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT8_ID AS GL_SEGMENT8_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT5_ID AS GL_SEGMENT5_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT1_ID AS GL_SEGMENT1_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT7_ID AS GL_SEGMENT7_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT10_ID AS GL_SEGMENT10_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.FINANCIAL_GL_FLG AS FINANCIAL_GL_FLG ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.CARRY_FORWARD_LOC_AMT AS CARRY_FORWARD_LOC_AMT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.CARRY_FORWARD_ACCT_AMT AS CARRY_FORWARD_ACCT_AMT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGETARY_CONTROL_FLG AS BUDGETARY_CONTROL_FLG ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_TYPE_WID AS BALANCE_TYPE_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_ID AS BALANCE_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROGRAM_ID AS SEG_PROGRAM_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROJECT_ID AS SEG_PROJECT_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_WID AS BUDGET_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_MCAL_CAL_WID AS BUDGET_MCAL_CAL_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_LEDGER_ID AS BUDGET_LEDGER_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_PERIOD_WID AS BUDGET_PERIOD_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_CUSTOM AS X_CUSTOM ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCING_SEGMENT_ID AS BALANCING_SEGMENT_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.DB_CR_IND AS DB_CR_IND ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DT_WID AS BALANCE_DT_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_LOC_AMT AS BALANCE_LOC_AMT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUSN_AREA_ORG_WID AS BUSN_AREA_ORG_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_ACCOUNT_WID AS GL_ACCOUNT_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.MCAL_CAL_WID AS MCAL_CAL_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.AUX3_CHANGED_ON_DT AS AUX3_CHANGED_ON_DT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.TRANSLATED_FLAG AS TRANSLATED_FLAG ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.AUX1_CHANGED_ON_DT AS AUX1_CHANGED_ON_DT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.SUMMARY_ACCOUNT_FLAG AS SUMMARY_ACCOUNT_FLAG ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.MANAGEMENT_SEGMENT_NUM AS MANAGEMENT_SEGMENT_NUM ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.LOC_CURR_CODE AS LOC_CURR_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.NATURAL_ACCOUNT_ATTRIB AS NATURAL_ACCOUNT_ATTRIB ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.ACCT_CURR_CODE AS ACCT_CURR_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.COST_CENTER_ID AS COST_CENTER_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCING_SEGMENT_NUM AS BALANCING_SEGMENT_NUM ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.COST_CENTER_NUM AS COST_CENTER_NUM ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCING_SEGMENT_ATTRIB AS BALANCING_SEGMENT_ATTRIB ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.ADJUSTMENT_FLAG AS ADJUSTMENT_FLAG ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_TYPE_FLAG AS BALANCE_TYPE_FLAG ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.ACTIVITY_LOC_AMT AS ACTIVITY_LOC_AMT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.LAST_UPDATE_DATE AS LAST_UPDATE_DATE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.AUX4_CHANGED_ON_DT AS AUX4_CHANGED_ON_DT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.TENANT_ID AS TENANT_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE AS BALANCE_DATE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.COST_CENTER_ATTRIB AS COST_CENTER_ATTRIB ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.NATURAL_ACCOUNT_NUM AS NATURAL_ACCOUNT_NUM ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.INTEGRATION_ID AS INTEGRATION_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.COMPANY_ORG_ID AS COMPANY_ORG_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.NATURAL_ACCOUNT_ID AS NATURAL_ACCOUNT_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.ACTIVITY_ACCT_AMT AS ACTIVITY_ACCT_AMT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEDGER_ID AS LEDGER_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.AUX2_CHANGED_ON_DT AS AUX2_CHANGED_ON_DT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_ACCT_AMT AS BALANCE_ACCT_AMT ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DT_WID_KEY AS BALANCE_DT_WID_KEY ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEGAL_ENTITY_ID AS LEGAL_ENTITY_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT1_ID AS BUDGET_SEGMENT1_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_ACCOUNT_WID AS BUDGET_ACCOUNT_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT8_ID AS BUDGET_SEGMENT8_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT7_ID AS BUDGET_SEGMENT7_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT2_ID AS BUDGET_SEGMENT2_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT6_ID AS BUDGET_SEGMENT6_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT10_ID AS BUDGET_SEGMENT10_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT9_ID AS BUDGET_SEGMENT9_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT3_ID AS BUDGET_SEGMENT3_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT5_ID AS BUDGET_SEGMENT5_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT4_ID AS BUDGET_SEGMENT4_ID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT1_CODE AS X_SEGMENT1_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT2_CODE AS X_SEGMENT2_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT3_CODE AS X_SEGMENT3_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT4_CODE AS X_SEGMENT4_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT5_CODE AS X_SEGMENT5_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT6_CODE AS X_SEGMENT6_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT7_CODE AS X_SEGMENT7_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT8_CODE AS X_SEGMENT8_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_SEGMENT9_CODE AS X_SEGMENT9_CODE ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_TS_YEAR_WID AS X_TS_YEAR_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_TS_PERIOD_WID AS X_TS_PERIOD_WID ,
  SQ_GL_BALANCES_FS_SQ_GL_BALANC.X_TS_DATE_WID AS X_TS_DATE_WID ,
  (
SELECT 
  W_BUDGET_SEGMENT_D10.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D10.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D10  
  ) W_BUDGET_SEGMENT_D10  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT10_ID=W_BUDGET_SEGMENT_D10.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID
) ) AS COL ,
  (
SELECT 
  W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D10  
  ) W_BUDGET_SEGMENT_D10  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT10_ID=W_BUDGET_SEGMENT_D10.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID
) ) AS COL_1 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D10  
  ) W_BUDGET_SEGMENT_D10  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT10_ID=W_BUDGET_SEGMENT_D10.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D10.DATASOURCE_NUM_ID
) ) AS COL_2 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D9.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D9.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D9  
  ) W_BUDGET_SEGMENT_D9  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT9_ID=W_BUDGET_SEGMENT_D9.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID
) ) AS COL_3 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D9  
  ) W_BUDGET_SEGMENT_D9  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT9_ID=W_BUDGET_SEGMENT_D9.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID
) ) AS COL_4 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D9  
  ) W_BUDGET_SEGMENT_D9  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT9_ID=W_BUDGET_SEGMENT_D9.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D9.DATASOURCE_NUM_ID
) ) AS COL_5 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D8.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D8.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D8  
  ) W_BUDGET_SEGMENT_D8  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT8_ID=W_BUDGET_SEGMENT_D8.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID
) ) AS COL_6 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D8  
  ) W_BUDGET_SEGMENT_D8  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT8_ID=W_BUDGET_SEGMENT_D8.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID
) ) AS COL_7 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D8  
  ) W_BUDGET_SEGMENT_D8  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT8_ID=W_BUDGET_SEGMENT_D8.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D8.DATASOURCE_NUM_ID
) ) AS COL_8 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D7.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D7.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D7  
  ) W_BUDGET_SEGMENT_D7  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT7_ID=W_BUDGET_SEGMENT_D7.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID
) ) AS COL_9 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D7  
  ) W_BUDGET_SEGMENT_D7  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT7_ID=W_BUDGET_SEGMENT_D7.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID
) ) AS COL_10 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D7  
  ) W_BUDGET_SEGMENT_D7  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT7_ID=W_BUDGET_SEGMENT_D7.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D7.DATASOURCE_NUM_ID
) ) AS COL_11 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D4.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D4.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D4  
  ) W_BUDGET_SEGMENT_D4  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT4_ID=W_BUDGET_SEGMENT_D4.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID
) ) AS COL_12 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D4  
  ) W_BUDGET_SEGMENT_D4  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT4_ID=W_BUDGET_SEGMENT_D4.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID
) ) AS COL_13 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D4  
  ) W_BUDGET_SEGMENT_D4  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT4_ID=W_BUDGET_SEGMENT_D4.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D4.DATASOURCE_NUM_ID
) ) AS COL_14 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D3.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D3.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D3.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D3  
  ) W_BUDGET_SEGMENT_D3  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT3_ID=W_BUDGET_SEGMENT_D3.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID
) ) AS COL_15 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D3.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D3  
  ) W_BUDGET_SEGMENT_D3  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT3_ID=W_BUDGET_SEGMENT_D3.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID
) ) AS COL_16 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D3.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D3.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D3  
  ) W_BUDGET_SEGMENT_D3  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT3_ID=W_BUDGET_SEGMENT_D3.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D3.DATASOURCE_NUM_ID
) ) AS COL_17 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D2.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D2.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D2  
  ) W_BUDGET_SEGMENT_D2  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT2_ID=W_BUDGET_SEGMENT_D2.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID
) ) AS COL_18 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D2  
  ) W_BUDGET_SEGMENT_D2  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT2_ID=W_BUDGET_SEGMENT_D2.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID
) ) AS COL_19 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D2  
  ) W_BUDGET_SEGMENT_D2  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT2_ID=W_BUDGET_SEGMENT_D2.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D2.DATASOURCE_NUM_ID
) ) AS COL_20 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D1.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_SEGMENT_D1.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D1  
  ) W_BUDGET_SEGMENT_D1  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT1_ID=W_BUDGET_SEGMENT_D1.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID
) ) AS COL_21 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D1  
  ) W_BUDGET_SEGMENT_D1  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT1_ID=W_BUDGET_SEGMENT_D1.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID
) ) AS COL_22 ,
  (
SELECT 
  W_BUDGET_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_BUDGET_SEGMENT_D W_BUDGET_SEGMENT_D1  
  ) W_BUDGET_SEGMENT_D1  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.BUDGET_SEGMENT1_ID=W_BUDGET_SEGMENT_D1.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_BUDGET_SEGMENT_D1.DATASOURCE_NUM_ID
) ) AS COL_23 ,
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT   
FROM 
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_INT_ORG_D.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_INT_ORG_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_INT_ORG_D.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_INT_ORG_D LKP_W_INT_ORG_D  
  ) LKP_W_INT_ORG_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID = LKP_W_INT_ORG_D.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALANC.COMPANY_ORG_ID,'COMPANY~'||SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEGAL_ENTITY_ID) = LKP_W_INT_ORG_D.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE >= LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE < LKP_W_INT_ORG_D.EFFECTIVE_TO_DT
) ) AS COL_24 ,
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT   
FROM 
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_INT_ORG_D.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_INT_ORG_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_INT_ORG_D.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_INT_ORG_D LKP_W_INT_ORG_D  
  ) LKP_W_INT_ORG_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID = LKP_W_INT_ORG_D.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALANC.COMPANY_ORG_ID,'COMPANY~'||SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEGAL_ENTITY_ID) = LKP_W_INT_ORG_D.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE >= LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE < LKP_W_INT_ORG_D.EFFECTIVE_TO_DT
) ) AS COL_25 ,
  (
SELECT 
  LKP_W_INT_ORG_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_INT_ORG_D.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_INT_ORG_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_INT_ORG_D.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_INT_ORG_D LKP_W_INT_ORG_D  
  ) LKP_W_INT_ORG_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID = LKP_W_INT_ORG_D.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALANC.COMPANY_ORG_ID,'COMPANY~'||SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEGAL_ENTITY_ID) = LKP_W_INT_ORG_D.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE >= LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE < LKP_W_INT_ORG_D.EFFECTIVE_TO_DT
) ) AS COL_26 ,
  (
SELECT 
  LKP_W_INT_ORG_D.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_INT_ORG_D.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_INT_ORG_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_INT_ORG_D.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_INT_ORG_D LKP_W_INT_ORG_D  
  ) LKP_W_INT_ORG_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID = LKP_W_INT_ORG_D.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALANC.COMPANY_ORG_ID,'COMPANY~'||SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEGAL_ENTITY_ID) = LKP_W_INT_ORG_D.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE >= LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE < LKP_W_INT_ORG_D.EFFECTIVE_TO_DT
) ) AS COL_27 ,
  (
SELECT 
  LKP_W_INT_ORG_D.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  LKP_W_INT_ORG_D.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  LKP_W_INT_ORG_D.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_INT_ORG_D.INTEGRATION_ID AS INTEGRATION_ID ,
  LKP_W_INT_ORG_D.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_INT_ORG_D LKP_W_INT_ORG_D  
  ) LKP_W_INT_ORG_D  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID = LKP_W_INT_ORG_D.DATASOURCE_NUM_ID
AND	COALESCE(SQ_GL_BALANCES_FS_SQ_GL_BALANC.COMPANY_ORG_ID,'COMPANY~'||SQ_GL_BALANCES_FS_SQ_GL_BALANC.LEGAL_ENTITY_ID) = LKP_W_INT_ORG_D.INTEGRATION_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE >= LKP_W_INT_ORG_D.EFFECTIVE_FROM_DT
AND	SQ_GL_BALANCES_FS_SQ_GL_BALANC.BALANCE_DATE < LKP_W_INT_ORG_D.EFFECTIVE_TO_DT
) ) AS COL_28 ,
  (
SELECT 
  W_GL_SEGMENT_D_PROGRAM.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D_PROGRAM.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D_PROGRAM  
  ) W_GL_SEGMENT_D_PROGRAM  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROGRAM_ID=W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AND 
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID
) ) AS COL_29 ,
  (
SELECT 
  W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D_PROGRAM  
  ) W_GL_SEGMENT_D_PROGRAM  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROGRAM_ID=W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AND 
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID
) ) AS COL_30 ,
  (
SELECT 
  W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D_PROGRAM  
  ) W_GL_SEGMENT_D_PROGRAM  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROGRAM_ID=W_GL_SEGMENT_D_PROGRAM.INTEGRATION_ID AND 
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D_PROGRAM.DATASOURCE_NUM_ID
) ) AS COL_31 ,
  (
SELECT 
  W_GL_SEGMENT_D_PROJECT.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D_PROJECT.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D_PROJECT  
  ) W_GL_SEGMENT_D_PROJECT  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROJECT_ID=W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID 
AND SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID
) ) AS COL_32 ,
  (
SELECT 
  W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D_PROJECT  
  ) W_GL_SEGMENT_D_PROJECT  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROJECT_ID=W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID 
AND SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID
) ) AS COL_33 ,
  (
SELECT 
  W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D_PROJECT  
  ) W_GL_SEGMENT_D_PROJECT  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.SEG_PROJECT_ID=W_GL_SEGMENT_D_PROJECT.INTEGRATION_ID 
AND SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D_PROJECT.DATASOURCE_NUM_ID
) ) AS COL_34 ,
  (
SELECT 
  W_GL_SEGMENT_D10.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D10.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D10  
  ) W_GL_SEGMENT_D10  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT10_ID=W_GL_SEGMENT_D10.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D10.DATASOURCE_NUM_ID
) ) AS COL_35 ,
  (
SELECT 
  W_GL_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D10  
  ) W_GL_SEGMENT_D10  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT10_ID=W_GL_SEGMENT_D10.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D10.DATASOURCE_NUM_ID
) ) AS COL_36 ,
  (
SELECT 
  W_GL_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D10.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D10.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D10  
  ) W_GL_SEGMENT_D10  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT10_ID=W_GL_SEGMENT_D10.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D10.DATASOURCE_NUM_ID
) ) AS COL_37 ,
  (
SELECT 
  W_GL_SEGMENT_D9.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D9.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D9  
  ) W_GL_SEGMENT_D9  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT9_ID=W_GL_SEGMENT_D9.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D9.DATASOURCE_NUM_ID
) ) AS COL_38 ,
  (
SELECT 
  W_GL_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D9  
  ) W_GL_SEGMENT_D9  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT9_ID=W_GL_SEGMENT_D9.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D9.DATASOURCE_NUM_ID
) ) AS COL_39 ,
  (
SELECT 
  W_GL_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D9.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D9.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D9  
  ) W_GL_SEGMENT_D9  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT9_ID=W_GL_SEGMENT_D9.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D9.DATASOURCE_NUM_ID
) ) AS COL_40 ,
  (
SELECT 
  W_GL_SEGMENT_D8.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D8.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D8  
  ) W_GL_SEGMENT_D8  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT8_ID=W_GL_SEGMENT_D8.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D8.DATASOURCE_NUM_ID
) ) AS COL_41 ,
  (
SELECT 
  W_GL_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D8  
  ) W_GL_SEGMENT_D8  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT8_ID=W_GL_SEGMENT_D8.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D8.DATASOURCE_NUM_ID
) ) AS COL_42 ,
  (
SELECT 
  W_GL_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D8.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D8.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D8  
  ) W_GL_SEGMENT_D8  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT8_ID=W_GL_SEGMENT_D8.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D8.DATASOURCE_NUM_ID
) ) AS COL_43 ,
  (
SELECT 
  W_GL_SEGMENT_D7.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D7.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D7  
  ) W_GL_SEGMENT_D7  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT7_ID=W_GL_SEGMENT_D7.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D7.DATASOURCE_NUM_ID
) ) AS COL_44 ,
  (
SELECT 
  W_GL_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D7  
  ) W_GL_SEGMENT_D7  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT7_ID=W_GL_SEGMENT_D7.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D7.DATASOURCE_NUM_ID
) ) AS COL_45 ,
  (
SELECT 
  W_GL_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D7.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D7.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D7  
  ) W_GL_SEGMENT_D7  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT7_ID=W_GL_SEGMENT_D7.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D7.DATASOURCE_NUM_ID
) ) AS COL_46 ,
  (
SELECT 
  W_GL_SEGMENT_D6.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D6.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D6.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D6.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D6  
  ) W_GL_SEGMENT_D6  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT6_ID=W_GL_SEGMENT_D6.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D6.DATASOURCE_NUM_ID
) ) AS COL_47 ,
  (
SELECT 
  W_GL_SEGMENT_D6.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D6.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D6.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D6  
  ) W_GL_SEGMENT_D6  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT6_ID=W_GL_SEGMENT_D6.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D6.DATASOURCE_NUM_ID
) ) AS COL_48 ,
  (
SELECT 
  W_GL_SEGMENT_D6.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D6.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D6.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D6  
  ) W_GL_SEGMENT_D6  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT6_ID=W_GL_SEGMENT_D6.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D6.DATASOURCE_NUM_ID
) ) AS COL_49 ,
  (
SELECT 
  W_GL_SEGMENT_D5.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D5.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D5.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D5.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D5  
  ) W_GL_SEGMENT_D5  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT5_ID=W_GL_SEGMENT_D5.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D5.DATASOURCE_NUM_ID
) ) AS COL_50 ,
  (
SELECT 
  W_GL_SEGMENT_D5.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D5.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D5.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D5  
  ) W_GL_SEGMENT_D5  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT5_ID=W_GL_SEGMENT_D5.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D5.DATASOURCE_NUM_ID
) ) AS COL_51 ,
  (
SELECT 
  W_GL_SEGMENT_D5.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D5.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D5.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D5  
  ) W_GL_SEGMENT_D5  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT5_ID=W_GL_SEGMENT_D5.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D5.DATASOURCE_NUM_ID
) ) AS COL_52 ,
  (
SELECT 
  W_GL_SEGMENT_D4.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D4.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D4  
  ) W_GL_SEGMENT_D4  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT4_ID=W_GL_SEGMENT_D4.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D4.DATASOURCE_NUM_ID
) ) AS COL_53 ,
  (
SELECT 
  W_GL_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D4  
  ) W_GL_SEGMENT_D4  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT4_ID=W_GL_SEGMENT_D4.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D4.DATASOURCE_NUM_ID
) ) AS COL_54 ,
  (
SELECT 
  W_GL_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D4.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D4.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D4  
  ) W_GL_SEGMENT_D4  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT4_ID=W_GL_SEGMENT_D4.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D4.DATASOURCE_NUM_ID
) ) AS COL_55 ,
  (
SELECT 
  W_GL_SEGMENT_D2.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D2.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D2  
  ) W_GL_SEGMENT_D2  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT2_ID=W_GL_SEGMENT_D2.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D2.DATASOURCE_NUM_ID
) ) AS COL_56 ,
  (
SELECT 
  W_GL_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D2  
  ) W_GL_SEGMENT_D2  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT2_ID=W_GL_SEGMENT_D2.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D2.DATASOURCE_NUM_ID
) ) AS COL_57 ,
  (
SELECT 
  W_GL_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D2.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D2.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D2  
  ) W_GL_SEGMENT_D2  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT2_ID=W_GL_SEGMENT_D2.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D2.DATASOURCE_NUM_ID
) ) AS COL_58 ,
  (
SELECT 
  W_GL_SEGMENT_D1.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID ,
  W_GL_SEGMENT_D1.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D1  
  ) W_GL_SEGMENT_D1  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT1_ID=W_GL_SEGMENT_D1.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D1.DATASOURCE_NUM_ID
) ) AS COL_59 ,
  (
SELECT 
  W_GL_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D1  
  ) W_GL_SEGMENT_D1  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT1_ID=W_GL_SEGMENT_D1.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D1.DATASOURCE_NUM_ID
) ) AS COL_60 ,
  (
SELECT 
  W_GL_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  (
SELECT 
  W_GL_SEGMENT_D1.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_GL_SEGMENT_D1.INTEGRATION_ID AS INTEGRATION_ID   
FROM 
  PRXBI_DW.W_GL_SEGMENT_D W_GL_SEGMENT_D1  
  ) W_GL_SEGMENT_D1  
WHERE
  (SQ_GL_BALANCES_FS_SQ_GL_BALANC.GL_SEGMENT1_ID=W_GL_SEGMENT_D1.INTEGRATION_ID
AND
SQ_GL_BALANCES_FS_SQ_GL_BALANC.DATASOURCE_NUM_ID=W_GL_SEGMENT_D1.DATASOURCE_NUM_ID
) ) AS COL_61   
FROM 
  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG6_INTEGRATION_ID	AS GL_SEGMENT6_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG2_INTEGRATION_ID	AS GL_SEGMENT2_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG4_INTEGRATION_ID	AS GL_SEGMENT4_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG9_INTEGRATION_ID	AS GL_SEGMENT9_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG3_INTEGRATION_ID	AS GL_SEGMENT3_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG8_INTEGRATION_ID	AS GL_SEGMENT8_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG5_INTEGRATION_ID	AS GL_SEGMENT5_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG1_INTEGRATION_ID	AS GL_SEGMENT1_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG7_INTEGRATION_ID	AS GL_SEGMENT7_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG10_INTEGRATION_ID	AS GL_SEGMENT10_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.FINANCIAL_GL_FLG	AS FINANCIAL_GL_FLG,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.CARRY_FORWARD_LOC_AMT	AS CARRY_FORWARD_LOC_AMT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.CARRY_FORWARD_ACCT_AMT	AS CARRY_FORWARD_ACCT_AMT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BUDGETARY_CONTROL_FLG	AS BUDGETARY_CONTROL_FLG,
	(
SELECT 
  W_XACT_TYPE_D_SQ_GL_BALANCES_F.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  W_XACT_TYPE_D_SQ_GL_BALANCES_F.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_XACT_TYPE_D_SQ_GL_BALANCES_F.INTEGRATION_ID AS INTEGRATION_ID ,
  W_XACT_TYPE_D_SQ_GL_BALANCES_F.ROW_WID AS ROW_WID   
FROM 
  PRXBI_DW.W_XACT_TYPE_D W_XACT_TYPE_D_SQ_GL_BALANCES_F  
  ) W_XACT_TYPE_D_SQ_GL_BALANCES_F  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_TYPE_ID=W_XACT_TYPE_D_SQ_GL_BALANCES_F.INTEGRATION_ID
AND 
W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_XACT_TYPE_D_SQ_GL_BALANCES_F.DATASOURCE_NUM_ID
) )	AS BALANCE_TYPE_WID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_ID	AS BALANCE_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.PROGRAM_INTEGRATION_ID	AS SEG_PROGRAM_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.PROJECT_INTEGRATION_ID	AS SEG_PROJECT_ID,
	(
SELECT 
  W_BUDGET_D_SQ_GL_BALANCES_FS.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  W_BUDGET_D_SQ_GL_BALANCES_FS.INTEGRATION_ID AS INTEGRATION_ID ,
  W_BUDGET_D_SQ_GL_BALANCES_FS.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_BUDGET_D_SQ_GL_BALANCES_FS.ROW_WID AS ROW_WID   
FROM 
  PRXBI_DW.W_BUDGET_D W_BUDGET_D_SQ_GL_BALANCES_FS  
  ) W_BUDGET_D_SQ_GL_BALANCES_FS  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.BUDGET_ID=W_BUDGET_D_SQ_GL_BALANCES_FS.INTEGRATION_ID AND
W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_BUDGET_D_SQ_GL_BALANCES_FS.DATASOURCE_NUM_ID
) )	AS BUDGET_WID,
	(
SELECT 
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  (
SELECT 
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.INTEGRATION_ID AS INTEGRATION_ID ,
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  PRXBI_DW.W_MCAL_PERIOD_D W_MCAL_PERIOD_D_BUDGET_PERIOD_  
  ) W_MCAL_PERIOD_D_BUDGET_PERIOD_  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.BUDGET_PERIOD_ID=W_MCAL_PERIOD_D_BUDGET_PERIOD_.INTEGRATION_ID AND W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_MCAL_PERIOD_D_BUDGET_PERIOD_.DATASOURCE_NUM_ID
) )	AS BUDGET_MCAL_CAL_WID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BUDGET_LEDGER_ID	AS BUDGET_LEDGER_ID,
	(
SELECT 
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.INTEGRATION_ID AS INTEGRATION_ID ,
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_MCAL_PERIOD_D_BUDGET_PERIOD_.ROW_WID AS ROW_WID   
FROM 
  PRXBI_DW.W_MCAL_PERIOD_D W_MCAL_PERIOD_D_BUDGET_PERIOD_  
  ) W_MCAL_PERIOD_D_BUDGET_PERIOD_  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.BUDGET_PERIOD_ID=W_MCAL_PERIOD_D_BUDGET_PERIOD_.INTEGRATION_ID AND W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_MCAL_PERIOD_D_BUDGET_PERIOD_.DATASOURCE_NUM_ID
) )	AS BUDGET_PERIOD_WID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.X_CUSTOM	AS X_CUSTOM,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCING_SEGMENT_ID	AS BALANCING_SEGMENT_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.DB_CR_IND	AS DB_CR_IND,
	(
SELECT 
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.ROW_WID AS ROW_WID   
FROM 
  (
SELECT 
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.INTEGRATION_ID AS INTEGRATION_ID ,
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.ROW_WID AS ROW_WID   
FROM 
  PRXBI_DW.W_MCAL_PERIOD_D W_MCAL_PERIOD_D_SQ_GL_BALANCES  
  ) W_MCAL_PERIOD_D_SQ_GL_BALANCES  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.PERIOD_ID=W_MCAL_PERIOD_D_SQ_GL_BALANCES.INTEGRATION_ID
AND W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_MCAL_PERIOD_D_SQ_GL_BALANCES.DATASOURCE_NUM_ID
) )	AS BALANCE_DT_WID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_LOC_AMT	AS BALANCE_LOC_AMT,
	(
SELECT 
  W_INT_ORG_D_SQ_GL_BALANCES_FS.SCD1_WID AS SCD1_WID   
FROM 
  (
SELECT 
  W_INT_ORG_D_SQ_GL_BALANCES_FS.EFFECTIVE_FROM_DT AS EFFECTIVE_FROM_DT ,
  W_INT_ORG_D_SQ_GL_BALANCES_FS.EFFECTIVE_TO_DT AS EFFECTIVE_TO_DT ,
  W_INT_ORG_D_SQ_GL_BALANCES_FS.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_INT_ORG_D_SQ_GL_BALANCES_FS.INTEGRATION_ID AS INTEGRATION_ID ,
  W_INT_ORG_D_SQ_GL_BALANCES_FS.SCD1_WID AS SCD1_WID   
FROM 
  PRXBI_DW.W_INT_ORG_D W_INT_ORG_D_SQ_GL_BALANCES_FS  
  ) W_INT_ORG_D_SQ_GL_BALANCES_FS  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.BUSN_AREA_ORG_ID=W_INT_ORG_D_SQ_GL_BALANCES_FS.INTEGRATION_ID
AND W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_INT_ORG_D_SQ_GL_BALANCES_FS.DATASOURCE_NUM_ID
AND W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE >= W_INT_ORG_D_SQ_GL_BALANCES_FS.EFFECTIVE_FROM_DT AND 
W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE < W_INT_ORG_D_SQ_GL_BALANCES_FS.EFFECTIVE_TO_DT
) )	AS BUSN_AREA_ORG_WID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ROW_WID	AS GL_ACCOUNT_WID,
	(
SELECT 
  W_MCAL_CONTEXT_G_SQ_GL_BALANCE.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  (
SELECT 
  W_MCAL_CONTEXT_G_SQ_GL_BALANCE.LEDGER_ID AS LEDGER_ID ,
  W_MCAL_CONTEXT_G_SQ_GL_BALANCE.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_MCAL_CONTEXT_G_SQ_GL_BALANCE.CONTEXT_CLASS AS CONTEXT_CLASS ,
  W_MCAL_CONTEXT_G_SQ_GL_BALANCE.MCAL_CAL_WID AS MCAL_CAL_WID   
FROM 
  PRXBI_DW.W_MCAL_CONTEXT_G W_MCAL_CONTEXT_G_SQ_GL_BALANCE  
  ) W_MCAL_CONTEXT_G_SQ_GL_BALANCE  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.LEDGER_ID=W_MCAL_CONTEXT_G_SQ_GL_BALANCE.LEDGER_ID 
AND 
W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_MCAL_CONTEXT_G_SQ_GL_BALANCE.DATASOURCE_NUM_ID
AND
W_MCAL_CONTEXT_G_SQ_GL_BALANCE.CONTEXT_CLASS='GL'
) )	AS MCAL_CAL_WID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.AUX3_CHANGED_ON_DT	AS AUX3_CHANGED_ON_DT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.TRANSLATED_FLAG	AS TRANSLATED_FLAG,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.AUX1_CHANGED_ON_DT	AS AUX1_CHANGED_ON_DT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.SUMMARY_ACCOUNT_FLAG	AS SUMMARY_ACCOUNT_FLAG,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.MANAGEMENT_SEGMENT_NUM	AS MANAGEMENT_SEGMENT_NUM,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.LOC_CURR_CODE	AS LOC_CURR_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.NATURAL_ACCOUNT_ATTRIB	AS NATURAL_ACCOUNT_ATTRIB,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.ACCT_CURR_CODE	AS ACCT_CURR_CODE,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.COST_CENTER_ID	AS COST_CENTER_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.BALANCING_SEGMENT_NUM	AS BALANCING_SEGMENT_NUM,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.COST_CENTER_NUM	AS COST_CENTER_NUM,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.BALANCING_SEGMENT_ATTRIB	AS BALANCING_SEGMENT_ATTRIB,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.ADJUSTMENT_FLAG	AS ADJUSTMENT_FLAG,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_TYPE_FLAG	AS BALANCE_TYPE_FLAG,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.ACTIVITY_LOC_AMT	AS ACTIVITY_LOC_AMT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.LAST_UPDATE_DATE	AS LAST_UPDATE_DATE,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.AUX4_CHANGED_ON_DT	AS AUX4_CHANGED_ON_DT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.TENANT_ID	AS TENANT_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE	AS BALANCE_DATE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.COST_CENTER_ATTRIB	AS COST_CENTER_ATTRIB,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.NATURAL_ACCOUNT_NUM	AS NATURAL_ACCOUNT_NUM,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.INTEGRATION_ID	AS INTEGRATION_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.COMPANY_ORG_ID	AS COMPANY_ORG_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.NATURAL_ACCOUNT_ID	AS NATURAL_ACCOUNT_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.ACTIVITY_ACCT_AMT	AS ACTIVITY_ACCT_AMT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.LEDGER_ID	AS LEDGER_ID,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.AUX2_CHANGED_ON_DT	AS AUX2_CHANGED_ON_DT,
	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_ACCT_AMT	AS BALANCE_ACCT_AMT,
	(
SELECT 
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.MCAL_PERIOD_END_DT_WID AS MCAL_PERIOD_END_DT_WID   
FROM 
  (
SELECT 
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.INTEGRATION_ID AS INTEGRATION_ID ,
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  W_MCAL_PERIOD_D_SQ_GL_BALANCES.MCAL_PERIOD_END_DT_WID AS MCAL_PERIOD_END_DT_WID   
FROM 
  PRXBI_DW.W_MCAL_PERIOD_D W_MCAL_PERIOD_D_SQ_GL_BALANCES  
  ) W_MCAL_PERIOD_D_SQ_GL_BALANCES  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.PERIOD_ID=W_MCAL_PERIOD_D_SQ_GL_BALANCES.INTEGRATION_ID
AND W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_MCAL_PERIOD_D_SQ_GL_BALANCES.DATASOURCE_NUM_ID
) )	AS BALANCE_DT_WID_KEY,
	(
SELECT 
  LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.LEGAL_ENTITY_ID AS LEGAL_ENTITY_ID   
FROM 
  (
SELECT 
  LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.LEGER_ID AS LEGER_ID ,
  LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.VALUE_SET_ID AS VALUE_SET_ID ,
  LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.SEGMENT_VALUE AS SEGMENT_VALUE ,
  LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.DATASOURCE_NUM_ID AS DATASOURCE_NUM_ID ,
  LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.LEGAL_ENTITY_ID AS LEGAL_ENTITY_ID   
FROM 
  PRXBI_DW.W_INT_ORG_D_BSV_LE LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B  
  ) LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B  
WHERE
  (W_GL_BALANCE_FS_SQ_GL_BALANCES.LEDGER_ID = LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.LEGER_ID 
AND W_GL_ACCOUNT_D_SQ_GL_BALANCES_.BALANCING_SEGMENT_ATTRIB = LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.VALUE_SET_ID
AND W_GL_ACCOUNT_D_SQ_GL_BALANCES_.BALANCING_SEGMENT_NUM = LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.SEGMENT_VALUE
AND W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID = LKP_W_INT_ORG_D_BSV_LE_SQ_GL_B.DATASOURCE_NUM_ID
) )	AS LEGAL_ENTITY_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG1_INTEGRATION_ID	AS BUDGET_SEGMENT1_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ROW_WID	AS BUDGET_ACCOUNT_WID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG8_INTEGRATION_ID	AS BUDGET_SEGMENT8_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG7_INTEGRATION_ID	AS BUDGET_SEGMENT7_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG2_INTEGRATION_ID	AS BUDGET_SEGMENT2_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG6_INTEGRATION_ID	AS BUDGET_SEGMENT6_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG10_INTEGRATION_ID	AS BUDGET_SEGMENT10_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG9_INTEGRATION_ID	AS BUDGET_SEGMENT9_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG3_INTEGRATION_ID	AS BUDGET_SEGMENT3_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG5_INTEGRATION_ID	AS BUDGET_SEGMENT5_ID,
	W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.ACCOUNT_SEG4_INTEGRATION_ID	AS BUDGET_SEGMENT4_ID,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG1_CODE	AS X_SEGMENT1_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG2_CODE	AS X_SEGMENT2_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG3_CODE	AS X_SEGMENT3_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG4_CODE	AS X_SEGMENT4_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG5_CODE	AS X_SEGMENT5_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG6_CODE	AS X_SEGMENT6_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG7_CODE	AS X_SEGMENT7_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG8_CODE	AS X_SEGMENT8_CODE,
	W_GL_ACCOUNT_D_SQ_GL_BALANCES_.ACCOUNT_SEG9_CODE	AS X_SEGMENT9_CODE,
	to_number(to_char(W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE,'YYYY'))	AS X_TS_YEAR_WID,
	to_number(to_char(W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE,'YYYYMM'))	AS X_TS_PERIOD_WID,
	to_number(to_char(W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE,'YYYYMMDD'))	AS X_TS_DATE_WID
from	(PRXBI_DW.W_GL_BALANCE_FS W_GL_BALANCE_FS_SQ_GL_BALANCES  LEFT OUTER JOIN  PRXBI_DW.W_GL_ACCOUNT_D W_GL_ACCOUNT_D_SQ_GL_BALANCES_  
    ON  W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_GL_ACCOUNT_D_SQ_GL_BALANCES_.DATASOURCE_NUM_ID
AND	W_GL_BALANCE_FS_SQ_GL_BALANCES.GL_ACCOUNT_ID=W_GL_ACCOUNT_D_SQ_GL_BALANCES_.INTEGRATION_ID
AND	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE>=W_GL_ACCOUNT_D_SQ_GL_BALANCES_.EFFECTIVE_FROM_DT
AND	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE<W_GL_ACCOUNT_D_SQ_GL_BALANCES_.EFFECTIVE_TO_DT
     )  LEFT OUTER JOIN  PRXBI_DW.W_BUDGET_ACCOUNT_D W_BUDGET_ACCOUNT_D_SQ_GL_BALAN  
    ON  W_GL_BALANCE_FS_SQ_GL_BALANCES.DATASOURCE_NUM_ID=W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.DATASOURCE_NUM_ID
AND	W_GL_BALANCE_FS_SQ_GL_BALANCES.BUDGET_ACCOUNT_ID=W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.INTEGRATION_ID
AND	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE>=W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.EFFECTIVE_FROM_DT
AND	W_GL_BALANCE_FS_SQ_GL_BALANCES.BALANCE_DATE<W_BUDGET_ACCOUNT_D_SQ_GL_BALAN.EFFECTIVE_TO_DT
where	(1=1)
)  SQ_GL_BALANCES_FS_SQ_GL_BALANC  
  ) SQ_GL_BALANCES_FS_SQ_GL_BALA_1  LEFT OUTER JOIN  
( /* Subselect from SIL_GLBalanceFact.W_GL_BALANCE_F
*/

select 
	  

	   W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.GLBL2_EXCH_RATE	AS GLBL2_EXCH_RATE,
	W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.DATASOURCE_NUM_ID	AS DATASOURCE_NUM_ID,
	W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.GLBL1_EXCH_RATE	AS GLBL1_EXCH_RATE,
	TRUNC(W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.EXCH_DATE,'DD')	AS EXCH_DATE,
	W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.W_FROM_CURRENCY_CODE	AS W_FROM_CURRENCY_CODE,
	W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.GLBL3_EXCH_RATE	AS GLBL3_EXCH_RATE,
	W_GLOBAL_EXCH_RATE_G_LKP_W_GLO.TENANT_ID	AS TENANT_ID
from	PRXBI_DW.W_GLOBAL_EXCH_RATE_G W_GLOBAL_EXCH_RATE_G_LKP_W_GLO
where	(1=1)
)  LKP_W_GLOBAL_EXCH_RATE_G_LKP_W  
    ON  SQ_GL_BALANCES_FS_SQ_GL_BALA_1.LOC_CURR_CODE = LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.W_FROM_CURRENCY_CODE
AND	TRUNC(SQ_GL_BALANCES_FS_SQ_GL_BALA_1.BALANCE_DATE,'DD') = LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.EXCH_DATE
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.DATASOURCE_NUM_ID = LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.DATASOURCE_NUM_ID
AND	SQ_GL_BALANCES_FS_SQ_GL_BALA_1.TENANT_ID = LKP_W_GLOBAL_EXCH_RATE_G_LKP_W.TENANT_ID
where    (1=1)
) C
LEFT OUTER JOIN PRXBI_DW.W_GL_BALANCE_F  T
 ON C.INTEGRATION_ID = T.INTEGRATION_ID AND
    C.DATASOURCE_NUM_ID = T.DATASOURCE_NUM_ID

   ",0,0,0,0
"Diagnostics - Fix Datatype Mismatches (Dim ETL)","IKM BIAPPS Oracle Fact Incremental Update",150,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step Bypassed */
   ",0,0,0,0
"Create Index on flow table","IKM BIAPPS Oracle Fact Incremental Update",160,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Creates an index on the unique key columns of the flow table */
create index	I$_2625555_5_UK
on		PRXBI_DW.I$_2625555_5 
(INTEGRATION_ID, DATASOURCE_NUM_ID
,IND_UPDATE
)
NOLOGGING
  ",0,0,0,0
"Analyze integration table","IKM BIAPPS Oracle Fact Incremental Update",170,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not collecting stats (ANALYZE_FLOW_TABLE option not set)*/
  ",0,0,0,0
"Insert affected partitions to part table I$","IKM BIAPPS Oracle Fact Incremental Update",180,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
  ",0,0,0,0
"Diagnostics - Create Target Replica Table","CKM BIAPPS Oracle",250,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed in Non Error Logging Mode */
  ",0,0,0,0
"Switch target between Interval and Range Partitioning","IKM BIAPPS Oracle Fact Incremental Update",190,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* No change required */
  ",0,0,0,0
"Create new partitions","IKM BIAPPS Oracle Fact Incremental Update",200,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
  ",0,0,0,0
"Refresh partition metadata (after create)","IKM BIAPPS Oracle Fact Incremental Update",210,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Only required for interval partitioned target in incremental load */
  ",0,0,0,0
"Flag rows for update","IKM BIAPPS Oracle Fact Incremental Update",220,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* For certain detection strategies the flow table update indicator needs to be set to U(pdate) */
/* if the record exists in the target table */
/* Command skipped due to chosen DETECTION_STRATEGY: OUTER */
  ",0,0,0,0
"Flag useless rows","IKM BIAPPS Oracle Fact Incremental Update",230,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* For certain detection strategies the flow table update indicator needs to be set to N (no action) */
/* if the existing record matches in the target table */
/* Command skipped due to chosen DETECTION_STRATEGY: OUTER */
  ",0,0,0,0
"Diagnostics - Flag bad rows in I$","CKM BIAPPS Oracle",320,0,"D","BIAPPS_DW","BIAPPS_DW","","

  ",0,0,0,0
"Diagnostics - Drop Target Replica Table","CKM BIAPPS Oracle",240,0,"D","BIAPPS_DW","BIAPPS_DW","","/*Error Logging not enabled */   ",0,0,0,0
"Diagnostics - Add DIAG columns to ReplicaTable","CKM BIAPPS Oracle",260,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed in Non Error Logging Mode */
  ",0,0,0,0
"Diagnostics - Find Dupes on I$ (Update)","CKM BIAPPS Oracle",270,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed in Non Error Logging Mode */
  ",0,0,0,0
"Diagnostics - Drop Target Replica Table","CKM BIAPPS Oracle",360,0,"D","BIAPPS_DW","BIAPPS_DW","","/*Error Logging not enabled */   ",0,0,0,0
"Diagnostics - Find Dupes,Cnstrnt Vltn rows on I$","CKM BIAPPS Oracle",280,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed in Non Error Logging Mode */
  ",0,0,0,0
"Diagnostics - Insert New Rows into Replica Table","CKM BIAPPS Oracle",290,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed in Non Error Logging Mode */
  ",0,0,0,0
"Diagnostics - Reinsert String violation records into Replica","CKM BIAPPS Oracle",300,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed in Non Error Logging Mode */
   ",0,0,0,0
"Diagnostics - Raise Error for Unacceptable Errors (Dim ETL)","CKM BIAPPS Oracle",310,0,"D","BIAPPS_DW","BIAPPS_DW","","  ",0,0,0,0
"Diagnostics - Selective Autocorrect of I$","CKM BIAPPS Oracle",330,0,"D","BIAPPS_DW","BIAPPS_DW","","BEGIN
NULL;

/* Error Logging not supported/Autocorrect not enabled/Not an Error Logging ETL run */ 

END;   ",0,0,0,0
"Diagnostics - Dim Fixes and E$ AutoCorrect Flag Update","CKM BIAPPS Oracle",340,0,"D","BIAPPS_DW","BIAPPS_DW","","BEGIN

 

 
NULL;
END;   ",0,0,0,0
"Diagnostics - Insert Diagnostic Summary Table","CKM BIAPPS Oracle",350,0,"D","BIAPPS_DW","BIAPPS_DW","","DECLARE
V_ERR_COUNT INTEGER;
BEGIN
/*Error Logging not enabled */ 
NULL;
END;  ",0,0,0,0
"Drop indexes","IKM BIAPPS Oracle Fact Incremental Update",370,0,"D","BIAPPS_DW","BIAPPS_DW","","

DECLARE
  v_EVENT_RESULT     VARCHAR2(100);
  v_ERRMESG          VARCHAR2(1000);  
  IndexDoesNotExist  EXCEPTION;
  pragma exception_init( IndexDoesNotExist,-1418);
  CURSOR index_csr IS
  SELECT
   INDEX_NAME,
   INDEX_TYPE,
   'DROP INDEX PRXBI_DW.' || INDEX_NAME INDEX_CMD
  FROM PRXBI_DW.W_ETL_ALL_INDEXES
  WHERE TABLE_NAME = 'W_GL_BALANCE_F'
  AND INDEX_TYPE = 'QUERY';
BEGIN
  -- Loop through indexes
  FOR index_rec IN index_csr LOOP
    -- Log initialize event
    EXECUTE IMMEDIATE 
      'INSERT INTO PRXBI_DW.W_ETL_EVENT_LOG
        (ETL_LOAD_PLAN_ID,ETL_SESS_NO,ETL_NNO,ETL_NB_RUN,ETL_SCEN_TASK_NO,EVENT_SEQ_NUM,
         EVENT_START_END_FLAG,EVENT_TYPE,EVENT_OBJECT,EVENT_OBJECT_TYPE,EVENT_TIMESTAMP,EVENT_RESULT)
       VALUES
        (:v_ETL_LOAD_PLAN_ID,:v_ETL_SESS_NO,:v_ETL_NNO,:v_ETL_NB_RUN,:v_ETL_SCEN_TASK_NO,:v_EVENT_SEQ_NUM,
         :v_EVENT_START_END_FLAG,:v_EVENT_TYPE,:v_EVENT_OBJECT,:v_EVENT_OBJECT_TYPE,:curdate,:v_EVENT_RESULT)' 
       USING
        #BIAPPS.EXECUTION_ID,2625555,5,
        1,1,1,0,'DROP_INDEX',index_rec.INDEX_NAME,index_rec.INDEX_TYPE,SYSDATE,'STARTED';
    COMMIT;
    -- Initialize event result
    v_EVENT_RESULT := 'SUCCESS';	
    v_ERRMESG := '';
    -- Drop Index
    BEGIN
      EXECUTE IMMEDIATE index_rec.INDEX_CMD;
    EXCEPTION
      WHEN IndexDoesNotExist THEN 
        v_EVENT_RESULT:= 'Warning: Index does not exist';
      WHEN OTHERS THEN 
        v_ERRMESG :='Error dropping index: ' || index_rec.INDEX_NAME || ' => ' || SQLERRM;
        v_EVENT_RESULT:= SUBSTR(SQLERRM,1,100);	    
    END;
    -- Log result
    EXECUTE IMMEDIATE 
      'INSERT INTO PRXBI_DW.W_ETL_EVENT_LOG
        (ETL_LOAD_PLAN_ID,ETL_SESS_NO,ETL_NNO,ETL_NB_RUN,ETL_SCEN_TASK_NO,EVENT_SEQ_NUM,
         EVENT_START_END_FLAG,EVENT_TYPE,EVENT_OBJECT,EVENT_OBJECT_TYPE,EVENT_TIMESTAMP,EVENT_RESULT)
       VALUES
        (:v_ETL_LOAD_PLAN_ID,:v_ETL_SESS_NO,:v_ETL_NNO,:v_ETL_NB_RUN,:v_ETL_SCEN_TASK_NO,:v_EVENT_SEQ_NUM,
         :v_EVENT_START_END_FLAG,:v_EVENT_TYPE,:v_EVENT_OBJECT,:v_EVENT_OBJECT_TYPE,:curdate,:v_EVENT_RESULT)'
      USING
       #BIAPPS.EXECUTION_ID,2625555,5,
       1,1,1,0,'DROP_INDEX',index_rec.INDEX_NAME,index_rec.INDEX_TYPE,SYSDATE,v_EVENT_RESULT;
    COMMIT;
    -- Raise exception if an error occurred
    IF v_ERRMESG IS NOT NULL THEN
      RAISE_APPLICATION_ERROR (-20000,v_ERRMESG);
    END IF;
  END LOOP;
END;

  ",0,0,0,0
"Drop local indexes (incremental)","IKM BIAPPS Oracle Fact Incremental Update",380,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
  ",0,0,0,0
"Run Alter Session1 Commands","IKM BIAPPS Oracle Fact Incremental Update",390,1,"D","BIAPPS_DW","BIAPPS_DW","","BEGIN

  NULL; 
END;   ",0,0,0,0
"Update existing rows","IKM BIAPPS Oracle Fact Incremental Update",400,2,"D","BIAPPS_DW","BIAPPS_DW","","
/* DETECTION_STRATEGY = OUTER */
MERGE #BIAPPS.ETL_HINT_UPDATE INTO	PRXBI_DW.W_GL_BALANCE_F T USING
  (	select	INTEGRATION_ID,
			DATASOURCE_NUM_ID,
			LEDGER_WID,
			COST_CENTER_WID,
			BALANCING_SEGMENT_WID,
			NATURAL_ACCOUNT_WID,
			COMPANY_ORG_WID,
			BUSN_AREA_ORG_WID,
			GL_ACCOUNT_WID,
			BALANCE_DT_WID,
			BALANCE_TM_WID,
			TREASURY_SYMBOL_WID,
			MCAL_CAL_WID,
			GL_DATASET_SEC_WID,
			DB_CR_IND,
			BALANCE_ACCT_AMT,
			BALANCE_LOC_AMT,
			BALANCE_GLOBAL1_AMT,
			BALANCE_GLOBAL2_AMT,
			BALANCE_GLOBAL3_AMT,
			ACTIVITY_ACCT_AMT,
			ACTIVITY_LOC_AMT,
			ACTIVITY_GLOBAL1_AMT,
			ACTIVITY_GLOBAL2_AMT,
			ACTIVITY_GLOBAL3_AMT,
			ACCT_CURR_CODE,
			LOC_CURR_CODE,
			TENANT_ID,
			X_CUSTOM,
			BALANCE_TYPE_FLAG,
			TRANSLATED_FLAG,
			SUMMARY_ACCOUNT_FLAG,
			CREATED_ON_DT,
			CHANGED_ON_DT,
			AUX1_CHANGED_ON_DT,
			AUX2_CHANGED_ON_DT,
			AUX3_CHANGED_ON_DT,
			AUX4_CHANGED_ON_DT,
			GL_SEGMENT1_WID,
			GL_SEGMENT2_WID,
			GL_SEGMENT3_WID,
			GL_SEGMENT4_WID,
			GL_SEGMENT5_WID,
			GL_SEGMENT6_WID,
			GL_SEGMENT7_WID,
			GL_SEGMENT8_WID,
			GL_SEGMENT9_WID,
			GL_SEGMENT10_WID,
			BUDGET_PERIOD_WID,
			BALANCE_TYPE_WID,
			CARRY_FORWARD_ACCT_AMT,
			CARRY_FORWARD_LOC_AMT,
			CARRY_FORWARD_GLOBAL1_AMT,
			CARRY_FORWARD_GLOBAL2_AMT,
			CARRY_FORWARD_GLOBAL3_AMT,
			FINANCIAL_GL_FLG,
			BUDGETARY_CONTROL_FLG,
			BALANCE_ID,
			SEG_PROJECT_WID,
			SEG_PROGRAM_WID,
			BUDGET_LEDGER_WID,
			BUDGET_MCAL_CAL_WID,
			BUDGET_WID,
			BALANCE_DT_KEY,
			BUDGET_ACCOUNT_WID,
			BUDGET_SEGMENT1_WID,
			BUDGET_SEGMENT2_WID,
			BUDGET_SEGMENT3_WID,
			BUDGET_SEGMENT4_WID,
			BUDGET_SEGMENT5_WID,
			BUDGET_SEGMENT6_WID,
			BUDGET_SEGMENT7_WID,
			BUDGET_SEGMENT8_WID,
			BUDGET_SEGMENT9_WID,
			BUDGET_SEGMENT10_WID,
			X_SEGMENT1_CODE,
			X_SEGMENT2_CODE,
			X_SEGMENT3_CODE,
			X_SEGMENT4_CODE,
			X_SEGMENT5_CODE,
			X_SEGMENT6_CODE,
			X_SEGMENT7_CODE,
			X_SEGMENT8_CODE,
			X_SEGMENT9_CODE,
			X_TS_YEAR_WID,
			X_TS_PERIOD_WID,
			X_TS_DATE_WID,
0 PROFIT_CENTER_WID,
			SYSDATE W_UPDATE_DT,
			#BIAPPS.ETL_PROC_WID ETL_PROC_WID,IND_UPDATE
		from	PRXBI_DW.I$_2625555_5 
	    	 ) S 
			 ON (S.IND_UPDATE = 'U' 
		AND	T.INTEGRATION_ID	=S.INTEGRATION_ID
		AND	T.DATASOURCE_NUM_ID	=S.DATASOURCE_NUM_ID )
WHEN MATCHED THEN UPDATE SET 
	T.LEDGER_WID=S.LEDGER_WID,
	T.COST_CENTER_WID=S.COST_CENTER_WID,
	T.BALANCING_SEGMENT_WID=S.BALANCING_SEGMENT_WID,
	T.NATURAL_ACCOUNT_WID=S.NATURAL_ACCOUNT_WID,
	T.COMPANY_ORG_WID=S.COMPANY_ORG_WID,
	T.BUSN_AREA_ORG_WID=S.BUSN_AREA_ORG_WID,
	T.GL_ACCOUNT_WID=S.GL_ACCOUNT_WID,
	T.BALANCE_DT_WID=S.BALANCE_DT_WID,
	T.BALANCE_TM_WID=S.BALANCE_TM_WID,
	T.TREASURY_SYMBOL_WID=S.TREASURY_SYMBOL_WID,
	T.MCAL_CAL_WID=S.MCAL_CAL_WID,
	T.GL_DATASET_SEC_WID=S.GL_DATASET_SEC_WID,
	T.DB_CR_IND=S.DB_CR_IND,
	T.BALANCE_ACCT_AMT=S.BALANCE_ACCT_AMT,
	T.BALANCE_LOC_AMT=S.BALANCE_LOC_AMT,
	T.BALANCE_GLOBAL1_AMT=S.BALANCE_GLOBAL1_AMT,
	T.BALANCE_GLOBAL2_AMT=S.BALANCE_GLOBAL2_AMT,
	T.BALANCE_GLOBAL3_AMT=S.BALANCE_GLOBAL3_AMT,
	T.ACTIVITY_ACCT_AMT=S.ACTIVITY_ACCT_AMT,
	T.ACTIVITY_LOC_AMT=S.ACTIVITY_LOC_AMT,
	T.ACTIVITY_GLOBAL1_AMT=S.ACTIVITY_GLOBAL1_AMT,
	T.ACTIVITY_GLOBAL2_AMT=S.ACTIVITY_GLOBAL2_AMT,
	T.ACTIVITY_GLOBAL3_AMT=S.ACTIVITY_GLOBAL3_AMT,
	T.ACCT_CURR_CODE=S.ACCT_CURR_CODE,
	T.LOC_CURR_CODE=S.LOC_CURR_CODE,
	T.TENANT_ID=S.TENANT_ID,
	T.X_CUSTOM=S.X_CUSTOM,
	T.BALANCE_TYPE_FLAG=S.BALANCE_TYPE_FLAG,
	T.TRANSLATED_FLAG=S.TRANSLATED_FLAG,
	T.SUMMARY_ACCOUNT_FLAG=S.SUMMARY_ACCOUNT_FLAG,
	T.CREATED_ON_DT=S.CREATED_ON_DT,
	T.CHANGED_ON_DT=S.CHANGED_ON_DT,
	T.AUX1_CHANGED_ON_DT=S.AUX1_CHANGED_ON_DT,
	T.AUX2_CHANGED_ON_DT=S.AUX2_CHANGED_ON_DT,
	T.AUX3_CHANGED_ON_DT=S.AUX3_CHANGED_ON_DT,
	T.AUX4_CHANGED_ON_DT=S.AUX4_CHANGED_ON_DT,
	T.GL_SEGMENT1_WID=S.GL_SEGMENT1_WID,
	T.GL_SEGMENT2_WID=S.GL_SEGMENT2_WID,
	T.GL_SEGMENT3_WID=S.GL_SEGMENT3_WID,
	T.GL_SEGMENT4_WID=S.GL_SEGMENT4_WID,
	T.GL_SEGMENT5_WID=S.GL_SEGMENT5_WID,
	T.GL_SEGMENT6_WID=S.GL_SEGMENT6_WID,
	T.GL_SEGMENT7_WID=S.GL_SEGMENT7_WID,
	T.GL_SEGMENT8_WID=S.GL_SEGMENT8_WID,
	T.GL_SEGMENT9_WID=S.GL_SEGMENT9_WID,
	T.GL_SEGMENT10_WID=S.GL_SEGMENT10_WID,
	T.BUDGET_PERIOD_WID=S.BUDGET_PERIOD_WID,
	T.BALANCE_TYPE_WID=S.BALANCE_TYPE_WID,
	T.CARRY_FORWARD_ACCT_AMT=S.CARRY_FORWARD_ACCT_AMT,
	T.CARRY_FORWARD_LOC_AMT=S.CARRY_FORWARD_LOC_AMT,
	T.CARRY_FORWARD_GLOBAL1_AMT=S.CARRY_FORWARD_GLOBAL1_AMT,
	T.CARRY_FORWARD_GLOBAL2_AMT=S.CARRY_FORWARD_GLOBAL2_AMT,
	T.CARRY_FORWARD_GLOBAL3_AMT=S.CARRY_FORWARD_GLOBAL3_AMT,
	T.FINANCIAL_GL_FLG=S.FINANCIAL_GL_FLG,
	T.BUDGETARY_CONTROL_FLG=S.BUDGETARY_CONTROL_FLG,
	T.BALANCE_ID=S.BALANCE_ID,
	T.SEG_PROJECT_WID=S.SEG_PROJECT_WID,
	T.SEG_PROGRAM_WID=S.SEG_PROGRAM_WID,
	T.BUDGET_LEDGER_WID=S.BUDGET_LEDGER_WID,
	T.BUDGET_MCAL_CAL_WID=S.BUDGET_MCAL_CAL_WID,
	T.BUDGET_WID=S.BUDGET_WID,
	T.BALANCE_DT_KEY=S.BALANCE_DT_KEY,
	T.BUDGET_ACCOUNT_WID=S.BUDGET_ACCOUNT_WID,
	T.BUDGET_SEGMENT1_WID=S.BUDGET_SEGMENT1_WID,
	T.BUDGET_SEGMENT2_WID=S.BUDGET_SEGMENT2_WID,
	T.BUDGET_SEGMENT3_WID=S.BUDGET_SEGMENT3_WID,
	T.BUDGET_SEGMENT4_WID=S.BUDGET_SEGMENT4_WID,
	T.BUDGET_SEGMENT5_WID=S.BUDGET_SEGMENT5_WID,
	T.BUDGET_SEGMENT6_WID=S.BUDGET_SEGMENT6_WID,
	T.BUDGET_SEGMENT7_WID=S.BUDGET_SEGMENT7_WID,
	T.BUDGET_SEGMENT8_WID=S.BUDGET_SEGMENT8_WID,
	T.BUDGET_SEGMENT9_WID=S.BUDGET_SEGMENT9_WID,
	T.BUDGET_SEGMENT10_WID=S.BUDGET_SEGMENT10_WID,
	T.X_SEGMENT1_CODE=S.X_SEGMENT1_CODE,
	T.X_SEGMENT2_CODE=S.X_SEGMENT2_CODE,
	T.X_SEGMENT3_CODE=S.X_SEGMENT3_CODE,
	T.X_SEGMENT4_CODE=S.X_SEGMENT4_CODE,
	T.X_SEGMENT5_CODE=S.X_SEGMENT5_CODE,
	T.X_SEGMENT6_CODE=S.X_SEGMENT6_CODE,
	T.X_SEGMENT7_CODE=S.X_SEGMENT7_CODE,
	T.X_SEGMENT8_CODE=S.X_SEGMENT8_CODE,
	T.X_SEGMENT9_CODE=S.X_SEGMENT9_CODE,
	T.X_TS_YEAR_WID=S.X_TS_YEAR_WID,
	T.X_TS_PERIOD_WID=S.X_TS_PERIOD_WID,
	T.X_TS_DATE_WID=S.X_TS_DATE_WID,
	T.PROFIT_CENTER_WID=S.PROFIT_CENTER_WID,
	T.W_UPDATE_DT=S.W_UPDATE_DT,
	T.ETL_PROC_WID=S.ETL_PROC_WID
  ",0,686,0,0
"Commit Transaction","IKM BIAPPS Oracle Fact Incremental Update",450,0,"D","BIAPPS_DW","BIAPPS_DW","","/*commit*/ ",0,0,0,0
"Drop Chunk Part I$ table (incremental)","IKM BIAPPS Oracle Fact Incremental Update",600,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
 ",0,0,0,0
"Insert new rows","IKM BIAPPS Oracle Fact Incremental Update",420,0,"D","BIAPPS_DW","BIAPPS_DW","","
 /* DETECTION_STRATEGY = OUTER */
insert  into 	PRXBI_DW.W_GL_BALANCE_F T
	(
	LEDGER_WID,
	COST_CENTER_WID,
	BALANCING_SEGMENT_WID,
	NATURAL_ACCOUNT_WID,
	COMPANY_ORG_WID,
	BUSN_AREA_ORG_WID,
	GL_ACCOUNT_WID,
	BALANCE_DT_WID,
	BALANCE_TM_WID,
	TREASURY_SYMBOL_WID,
	MCAL_CAL_WID,
	GL_DATASET_SEC_WID,
	DB_CR_IND,
	BALANCE_ACCT_AMT,
	BALANCE_LOC_AMT,
	BALANCE_GLOBAL1_AMT,
	BALANCE_GLOBAL2_AMT,
	BALANCE_GLOBAL3_AMT,
	ACTIVITY_ACCT_AMT,
	ACTIVITY_LOC_AMT,
	ACTIVITY_GLOBAL1_AMT,
	ACTIVITY_GLOBAL2_AMT,
	ACTIVITY_GLOBAL3_AMT,
	ACCT_CURR_CODE,
	LOC_CURR_CODE,
	INTEGRATION_ID,
	DATASOURCE_NUM_ID,
	TENANT_ID,
	X_CUSTOM,
	BALANCE_TYPE_FLAG,
	TRANSLATED_FLAG,
	SUMMARY_ACCOUNT_FLAG,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	AUX1_CHANGED_ON_DT,
	AUX2_CHANGED_ON_DT,
	AUX3_CHANGED_ON_DT,
	AUX4_CHANGED_ON_DT,
	GL_SEGMENT1_WID,
	GL_SEGMENT2_WID,
	GL_SEGMENT3_WID,
	GL_SEGMENT4_WID,
	GL_SEGMENT5_WID,
	GL_SEGMENT6_WID,
	GL_SEGMENT7_WID,
	GL_SEGMENT8_WID,
	GL_SEGMENT9_WID,
	GL_SEGMENT10_WID,
	BUDGET_PERIOD_WID,
	BALANCE_TYPE_WID,
	CARRY_FORWARD_ACCT_AMT,
	CARRY_FORWARD_LOC_AMT,
	CARRY_FORWARD_GLOBAL1_AMT,
	CARRY_FORWARD_GLOBAL2_AMT,
	CARRY_FORWARD_GLOBAL3_AMT,
	FINANCIAL_GL_FLG,
	BUDGETARY_CONTROL_FLG,
	BALANCE_ID,
	SEG_PROJECT_WID,
	SEG_PROGRAM_WID,
	BUDGET_LEDGER_WID,
	BUDGET_MCAL_CAL_WID,
	BUDGET_WID,
	BALANCE_DT_KEY,
	BUDGET_ACCOUNT_WID,
	BUDGET_SEGMENT1_WID,
	BUDGET_SEGMENT2_WID,
	BUDGET_SEGMENT3_WID,
	BUDGET_SEGMENT4_WID,
	BUDGET_SEGMENT5_WID,
	BUDGET_SEGMENT6_WID,
	BUDGET_SEGMENT7_WID,
	BUDGET_SEGMENT8_WID,
	BUDGET_SEGMENT9_WID,
	BUDGET_SEGMENT10_WID,
	X_SEGMENT1_CODE,
	X_SEGMENT2_CODE,
	X_SEGMENT3_CODE,
	X_SEGMENT4_CODE,
	X_SEGMENT5_CODE,
	X_SEGMENT6_CODE,
	X_SEGMENT7_CODE,
	X_SEGMENT8_CODE,
	X_SEGMENT9_CODE,
	X_TS_YEAR_WID,
	X_TS_PERIOD_WID,
	X_TS_DATE_WID
	,PROFIT_CENTER_WID,
	W_INSERT_DT,
	W_UPDATE_DT,
	ETL_PROC_WID
	)
select 	LEDGER_WID,
	COST_CENTER_WID,
	BALANCING_SEGMENT_WID,
	NATURAL_ACCOUNT_WID,
	COMPANY_ORG_WID,
	BUSN_AREA_ORG_WID,
	GL_ACCOUNT_WID,
	BALANCE_DT_WID,
	BALANCE_TM_WID,
	TREASURY_SYMBOL_WID,
	MCAL_CAL_WID,
	GL_DATASET_SEC_WID,
	DB_CR_IND,
	BALANCE_ACCT_AMT,
	BALANCE_LOC_AMT,
	BALANCE_GLOBAL1_AMT,
	BALANCE_GLOBAL2_AMT,
	BALANCE_GLOBAL3_AMT,
	ACTIVITY_ACCT_AMT,
	ACTIVITY_LOC_AMT,
	ACTIVITY_GLOBAL1_AMT,
	ACTIVITY_GLOBAL2_AMT,
	ACTIVITY_GLOBAL3_AMT,
	ACCT_CURR_CODE,
	LOC_CURR_CODE,
	INTEGRATION_ID,
	DATASOURCE_NUM_ID,
	TENANT_ID,
	X_CUSTOM,
	BALANCE_TYPE_FLAG,
	TRANSLATED_FLAG,
	SUMMARY_ACCOUNT_FLAG,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	AUX1_CHANGED_ON_DT,
	AUX2_CHANGED_ON_DT,
	AUX3_CHANGED_ON_DT,
	AUX4_CHANGED_ON_DT,
	GL_SEGMENT1_WID,
	GL_SEGMENT2_WID,
	GL_SEGMENT3_WID,
	GL_SEGMENT4_WID,
	GL_SEGMENT5_WID,
	GL_SEGMENT6_WID,
	GL_SEGMENT7_WID,
	GL_SEGMENT8_WID,
	GL_SEGMENT9_WID,
	GL_SEGMENT10_WID,
	BUDGET_PERIOD_WID,
	BALANCE_TYPE_WID,
	CARRY_FORWARD_ACCT_AMT,
	CARRY_FORWARD_LOC_AMT,
	CARRY_FORWARD_GLOBAL1_AMT,
	CARRY_FORWARD_GLOBAL2_AMT,
	CARRY_FORWARD_GLOBAL3_AMT,
	FINANCIAL_GL_FLG,
	BUDGETARY_CONTROL_FLG,
	BALANCE_ID,
	SEG_PROJECT_WID,
	SEG_PROGRAM_WID,
	BUDGET_LEDGER_WID,
	BUDGET_MCAL_CAL_WID,
	BUDGET_WID,
	BALANCE_DT_KEY,
	BUDGET_ACCOUNT_WID,
	BUDGET_SEGMENT1_WID,
	BUDGET_SEGMENT2_WID,
	BUDGET_SEGMENT3_WID,
	BUDGET_SEGMENT4_WID,
	BUDGET_SEGMENT5_WID,
	BUDGET_SEGMENT6_WID,
	BUDGET_SEGMENT7_WID,
	BUDGET_SEGMENT8_WID,
	BUDGET_SEGMENT9_WID,
	BUDGET_SEGMENT10_WID,
	X_SEGMENT1_CODE,
	X_SEGMENT2_CODE,
	X_SEGMENT3_CODE,
	X_SEGMENT4_CODE,
	X_SEGMENT5_CODE,
	X_SEGMENT6_CODE,
	X_SEGMENT7_CODE,
	X_SEGMENT8_CODE,
	X_SEGMENT9_CODE,
	X_TS_YEAR_WID,
	X_TS_PERIOD_WID,
	X_TS_DATE_WID
	,0,
	SYSDATE,
	SYSDATE,
	#BIAPPS.ETL_PROC_WID
from	PRXBI_DW.I$_2625555_5 S
where IND_UPDATE = 'I'
  ",0,0,0,0
"Insert reference dates","IKM BIAPPS Oracle Fact Incremental Update",430,0,"D","BIAPPS_DW","BIAPPS_DW","","--Check if records exists in W_ETL_LOAD_DATE TABLE
--Query run
--select count(1),MAX(LAST_MAX_DATE) from PRXBI_DW.W_ETL_LOAD_DATES where  DATASOURCE_NUM_ID = 999 and PACKAGE_NAME = 'SILOS_SIL_GLBALANCEFACT' and ETL_USAGE_CODE = '__NOT_APPLICABLE__'
--Result:1,2025-11-07 21:24:59.0

--Insert/Update reference dates

update PRXBI_DW.W_ETL_LOAD_DATES
set 
  TARGET_TABLE_NAME =   'W_GL_BALANCE_F',
  ETL_PROC_WID =   :BIAPPS.ETL_PROC_WID,
  LOAD_PLAN_ID = :BIAPPS.EXECUTION_ID,
  WIP_LOAD_START_DATE =   (SYSDATE+(-1)*#BIAPPS.PRUNE_DAYS),  

  ETL_LOAD_DATE =   SYSDATE,
  COMMITTED = DECODE('#BIAPPS.IS_INCREMENTAL','Y','1','0')
where DATASOURCE_NUM_ID = :BIAPPS.DATASOURCE_NUM_ID
and PACKAGE_NAME = 'SILOS_SIL_GLBALANCEFACT'
and ETL_USAGE_CODE = :BIAPPS.ETL_USAGE_CODE

  ",0,0,0,0
"Insert reference dates to History Table","IKM BIAPPS Oracle Fact Incremental Update",440,0,"D","BIAPPS_DW","BIAPPS_DW","","/* Insert/Update reference dates into History Table */
insert into PRXBI_DW.W_ETL_LOAD_DATES_LOG
 (DATASOURCE_NUM_ID,
  PACKAGE_NAME,
  TARGET_TABLE_NAME,
  ETL_USAGE_CODE,
  ETL_PROC_WID,
  LOAD_PLAN_ID,
  SESSION_ID,
  WIP_LOAD_START_DATE,
  LAST_MAX_DATE,
  ETL_LOAD_DATE,
  COMMITTED
 )
select
  DATASOURCE_NUM_ID,
  PACKAGE_NAME,
  TARGET_TABLE_NAME,
  ETL_USAGE_CODE,
  ETL_PROC_WID,
  LOAD_PLAN_ID,
  2625555,
  WIP_LOAD_START_DATE,
  LAST_MAX_DATE,
  ETL_LOAD_DATE,
  COMMITTED
FROM PRXBI_DW.W_ETL_LOAD_DATES
where DATASOURCE_NUM_ID = :BIAPPS.DATASOURCE_NUM_ID
and PACKAGE_NAME = 'SILOS_SIL_GLBALANCEFACT'
and ETL_USAGE_CODE = :BIAPPS.ETL_USAGE_CODE  ",0,0,0,0
"Load Chunk Part I$ table (incremental)","IKM BIAPPS Oracle Fact Incremental Update",500,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
  ",0,0,0,0
"Diagnostics - Find Duplicates and Autocorrect","IKM BIAPPS Oracle Fact Incremental Update",460,0,"D","BIAPPS_DW","BIAPPS_DW","","--Derive OBI_TABLE_MAINTENANCE behaviour for target table
--Table Truncate behaviour: FULL
--Truncate Table Behaviour Always ?:	false
--Is Full Mode ?:	false


/* Step bypassed */
  ",0,0,0,0
"Create indexes","IKM BIAPPS Oracle Fact Incremental Update",470,0,"D","BIAPPS_DW","BIAPPS_DW","","

DECLARE
  l_chunk_sql VARCHAR2(1000);
  l_sql_stmt VARCHAR2(32767);
  l_status NUMBER;
  l_no_chunks NUMBER;
BEGIN
  -- Drop task in case of restart
  BEGIN
    DBMS_PARALLEL_EXECUTE.DROP_TASK('CREATE_INDEXES_2625555');
  EXCEPTION WHEN OTHERS THEN
    NULL;
  END;
  -- Create the TASK
  DBMS_PARALLEL_EXECUTE.CREATE_TASK ('CREATE_INDEXES_2625555');
  -- Chunk the table by INDEX_NAME
  l_chunk_sql := 'SELECT INDEX_REF_ID, INDEX_REF_ID FROM PRXBI_DW.W_ETL_ALL_INDEXES WHERE TABLE_NAME=''W_GL_BALANCE_F''  AND INDEX_TYPE = ''QUERY'' ';
  DBMS_PARALLEL_EXECUTE.CREATE_CHUNKS_BY_SQL('CREATE_INDEXES_2625555', l_chunk_sql, false);
  -- Get count of chunks
  SELECT count(*) INTO l_no_chunks
  FROM user_parallel_execute_chunks
  WHERE task_name = 'CREATE_INDEXES_2625555';
  -- Execute the DML in parallel
  l_sql_stmt := 
'DECLARE
  v_INDEX_NAME     VARCHAR2(30);
  v_INDEX_TYPE     VARCHAR2(30);
  v_INDEX_CMD      VARCHAR2(4000);
  v_EVENT_RESULT   VARCHAR2(100);
  v_ERRMESG        VARCHAR2(1000);  
  IndexExists      EXCEPTION;
  pragma exception_init( IndexExists,-955);
BEGIN
  -- Load index details
  SELECT
   INDEX_NAME,
   INDEX_TYPE,
   ''CREATE '' || PRE_PARAMETERS || ''INDEX PRXBI_DW.'' || INDEX_NAME ||
   '' ON PRXBI_DW.'' || TABLE_NAME ||
   '' ('' || COLUMN_LIST || '')'' || POST_PARAMETERS ||
   CASE WHEN PRE_PARAMETERS = ''UNIQUE '' OR ''N'' = ''N'' THEN '' NOLOGGING'' ELSE '' NOLOGGING LOCAL'' END
  INTO v_INDEX_NAME, v_INDEX_TYPE, v_INDEX_CMD
  FROM PRXBI_DW.W_ETL_ALL_INDEXES
  WHERE INDEX_REF_ID = :start_id
  AND INDEX_REF_ID = :end_id
  AND TABLE_NAME = ''W_GL_BALANCE_F'';
  -- Log initialize event
  EXECUTE IMMEDIATE 
   ''INSERT INTO PRXBI_DW.W_ETL_EVENT_LOG
      (ETL_LOAD_PLAN_ID,ETL_SESS_NO,ETL_NNO,ETL_NB_RUN,ETL_SCEN_TASK_NO,EVENT_SEQ_NUM,
       EVENT_START_END_FLAG,EVENT_TYPE,EVENT_OBJECT,EVENT_OBJECT_TYPE,EVENT_TIMESTAMP,EVENT_RESULT)
     VALUES
      (:v_ETL_LOAD_PLAN_ID,:v_ETL_SESS_NO,:v_ETL_NNO,:v_ETL_NB_RUN,:v_ETL_SCEN_TASK_NO,:v_EVENT_SEQ_NUM,
       :v_EVENT_START_END_FLAG,:v_EVENT_TYPE,:v_EVENT_OBJECT,:v_EVENT_OBJECT_TYPE,:curdate,:v_EVENT_RESULT)'' 
     USING
      #BIAPPS.EXECUTION_ID,2625555,5,
      1,1,1,0,''CREATE_INDEX'',v_INDEX_NAME,v_INDEX_TYPE,SYSDATE,''STARTED'';
  COMMIT;
  -- Initialize event result
  v_EVENT_RESULT := ''SUCCESS'';	
  -- Create Index
  BEGIN
    EXECUTE IMMEDIATE v_INDEX_CMD;
  EXCEPTION
    WHEN IndexExists THEN 
      v_EVENT_RESULT:= ''Warning: Index already exists'';
    WHEN OTHERS THEN 
      v_ERRMESG :=''Error creating index: '' || v_INDEX_NAME || '' => '' || SQLERRM;
      v_EVENT_RESULT:= SUBSTR(SQLERRM,1,100);	    
  END;
  -- Log result
  EXECUTE IMMEDIATE 
   ''INSERT INTO PRXBI_DW.W_ETL_EVENT_LOG
      (ETL_LOAD_PLAN_ID,ETL_SESS_NO,ETL_NNO,ETL_NB_RUN,ETL_SCEN_TASK_NO,EVENT_SEQ_NUM,
       EVENT_START_END_FLAG,EVENT_TYPE,EVENT_OBJECT,EVENT_OBJECT_TYPE,EVENT_TIMESTAMP,EVENT_RESULT)
     VALUES
      (:v_ETL_LOAD_PLAN_ID,:v_ETL_SESS_NO,:v_ETL_NNO,:v_ETL_NB_RUN,:v_ETL_SCEN_TASK_NO,:v_EVENT_SEQ_NUM,
       :v_EVENT_START_END_FLAG,:v_EVENT_TYPE,:v_EVENT_OBJECT,:v_EVENT_OBJECT_TYPE,:curdate,:v_EVENT_RESULT)''
    USING
     #BIAPPS.EXECUTION_ID,2625555,5,
     1,1,1,0,''CREATE_INDEX'',v_INDEX_NAME,v_INDEX_TYPE,SYSDATE,v_EVENT_RESULT;
  COMMIT;
  -- Raise exception if an error occurred
  IF v_ERRMESG IS NOT NULL THEN
    RAISE_APPLICATION_ERROR (-20000,v_ERRMESG);
  END IF;
END;';
  -- Run Task in Parallel
  DBMS_PARALLEL_EXECUTE.RUN_TASK('CREATE_INDEXES_2625555', l_sql_stmt, DBMS_SQL.NATIVE, parallel_level => #BIAPPS.ETL_INDEX_BUILD_NUM_OF_PARALLEL_PROC);
  -- Get result
  l_status := DBMS_PARALLEL_EXECUTE.TASK_STATUS('CREATE_INDEXES_2625555');
  -- Done with processing; drop the task
  DBMS_PARALLEL_EXECUTE.DROP_TASK('CREATE_INDEXES_2625555');
  -- Raise error if process failed
  if l_status != DBMS_PARALLEL_EXECUTE.FINISHED and l_no_chunks > 0 then
    RAISE_APPLICATION_ERROR (-20000,'Error creating indexes in parallel, see W_ETL_EVENT_LOG for details');
  end if;
END;

  ",0,0,0,0
"Drop Chunk Part I$ table If Exists","IKM BIAPPS Oracle Fact Incremental Update",480,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
 ",0,0,0,0
"Create local indexes (incremental)","IKM BIAPPS Oracle Fact Incremental Update",510,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
  ",0,0,0,0
"Create Chunk Part I$ table (incremental)","IKM BIAPPS Oracle Fact Incremental Update",490,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
  ",0,0,0,0
"Refresh partition metadata (after full load)","IKM BIAPPS Oracle Fact Incremental Update",520,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Only required for interval partitioned target in full load */
  ",0,0,0,0
"Collect table partitions stale status","IKM BIAPPS Oracle Fact Incremental Update",530,0,"D","BIAPPS_DW","BIAPPS_DW","","
-- Table is not Partitioned / Full load mode, hence skipping collecting  table partitions stale status.
 ",0,0,0,0
"Gather stats","IKM BIAPPS Oracle Fact Incremental Update",540,817,"D","BIAPPS_DW","BIAPPS_DW","","
DECLARE
  v_EVENT_SEQ_NUM NUMBER(5,0) :=1;
  v_EVENT_RESULT VARCHAR2(100);
BEGIN
  -- Initialize Log
  v_EVENT_RESULT:= 'STARTED';
  EXECUTE IMMEDIATE 'INSERT INTO PRXBI_DW.W_ETL_EVENT_LOG
      (ETL_LOAD_PLAN_ID,ETL_SESS_NO,ETL_NNO,ETL_NB_RUN,ETL_SCEN_TASK_NO,EVENT_SEQ_NUM,
       EVENT_START_END_FLAG,EVENT_TYPE,EVENT_OBJECT,EVENT_OBJECT_TYPE,EVENT_TIMESTAMP,EVENT_RESULT)
     VALUES
      (:v_ETL_LOAD_PLAN_ID,:v_ETL_SESS_NO,:v_ETL_NNO,:v_ETL_NB_RUN,:v_ETL_SCEN_TASK_NO,:v_EVENT_SEQ_NUM,
       :v_EVENT_START_END_FLAG,:v_EVENT_TYPE,:v_EVENT_OBJECT,:v_EVENT_OBJECT_TYPE,:curdate,:v_EVENT_RESULT)'
		USING #BIAPPS.EXECUTION_ID,2625555,5,1,1,v_EVENT_SEQ_NUM,0,'GATHER_STATS','W_GL_BALANCE_F','TABLE',SYSDATE,v_EVENT_RESULT;
  COMMIT;
  DBMS_STATS.GATHER_TABLE_STATS
   (ownname => 'PRXBI_DW',
    tabname => 'W_GL_BALANCE_F',
    cascade => FALSE,
    estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,
    method_opt =>  'FOR ALL COLUMNS SIZE AUTO',
    degree => DBMS_STATS.DEFAULT_DEGREE);
  --Log Completion to Event Log
  v_EVENT_RESULT:= 'SUCCESS';
  EXECUTE IMMEDIATE 'INSERT INTO PRXBI_DW.W_ETL_EVENT_LOG
      (ETL_LOAD_PLAN_ID,ETL_SESS_NO,ETL_NNO,ETL_NB_RUN,ETL_SCEN_TASK_NO,EVENT_SEQ_NUM,
       EVENT_START_END_FLAG,EVENT_TYPE,EVENT_OBJECT,EVENT_OBJECT_TYPE,EVENT_TIMESTAMP,EVENT_RESULT)
     VALUES
      (:v_ETL_LOAD_PLAN_ID,:v_ETL_SESS_NO,:v_ETL_NNO,:v_ETL_NB_RUN,:v_ETL_SCEN_TASK_NO,:v_EVENT_SEQ_NUM,
       :v_EVENT_START_END_FLAG,:v_EVENT_TYPE,:v_EVENT_OBJECT,:v_EVENT_OBJECT_TYPE,:curdate,:v_EVENT_RESULT)'
		USING #BIAPPS.EXECUTION_ID,2625555,5,1,1,v_EVENT_SEQ_NUM,1,'GATHER_STATS','W_GL_BALANCE_F','TABLE',SYSDATE,v_EVENT_RESULT;
  COMMIT;  
END;
  ",0,0,0,0
"Drop partition package","IKM BIAPPS Oracle Fact Incremental Update",550,0,"D","BIAPPS_DW","BIAPPS_DW","","DROP PACKAGE PRXBI_DW.OBIA_PARTITION_2625555  ",0,0,0,0
"Drop part table","IKM BIAPPS Oracle Fact Incremental Update",570,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Not required */
 ",0,0,0,0
"Drop flow table","IKM BIAPPS Oracle Fact Incremental Update",560,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Optionally drops flow table */
drop table PRXBI_DW.I$_2625555_5 purge
  ",0,0,0,0
"Diagnostics - Update Committed Flag","IKM BIAPPS Oracle Fact Incremental Update",580,0,"D","BIAPPS_DW","BIAPPS_DW","","
/* Step bypassed */

  ",0,0,0,0
"Diagnostics - Drop Error Table if empty","IKM BIAPPS Oracle Fact Incremental Update",590,0,"D","BIAPPS_DW","BIAPPS_DW","","
DECLARE
	v_rowcount NUMBER := 1;
	v_cnt_query VARCHAR2(100);
BEGIN
SELECT COUNT(*) INTO v_rowcount FROM PRXBI_DW.E$_2625555_5;
IF v_rowcount = 0 THEN
	EXECUTE IMMEDIATE 'DROP TABLE PRXBI_DW.E$_2625555_5 PURGE';
END IF;
END;
  ",0,0,0,0
